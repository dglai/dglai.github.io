<head>
    <!-- meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Library for deep learning on graphs">
    <meta name="keywords" content="Software, Machine Learning, Deep Learning, Neural Network, Graph">
    <meta name="author" content="Themeix">

    <!-- Site Title -->
    <title>Deep Graph Library</title>

    <!-- favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/assets/images/dgl-favicon.png">

    <!-- IView CSS -->
    <link rel="stylesheet" href="//unpkg.com/iview/dist/styles/iview.css">

    <!-- Bootstrap CSS -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font-Awesome CSS -->
    <link href="/assets/css/font-awesome.min.css" rel="stylesheet">

    <!-- Google Fonts -->
    <link href="/assets/css/googlefont.css" rel="stylesheet"> 

    <!-- Animate CSS -->
    <link rel="stylesheet" href="/assets/css/animate.min.css">

    <!-- Owl Carousel CSS -->
    <link rel="stylesheet" href="/assets/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/assets/css/owl.theme.default.min.css">
    <!--<link rel="stylesheet" href="/assets/css/owl.carousel.min.css">-->

    <!-- Mean Menu CSS -->
    <link rel="stylesheet" href="/assets/css/meanmenu.min.css">

    <!-- Main Stylesheet -->
    <link href="/assets/css/style.css" rel="stylesheet">

    <!-- Responsive CSS -->
    <link href="/assets/css/responsive.css" rel="stylesheet">

    <!-- Minima CSS -->
    <link href="/assets/main.css" rel="stylesheet">

    <!-- Rouge Highlighter CSS -->
    <link href="/assets/css/syntax.css" rel="stylesheet">

    <link type="application/atom+xml" rel="alternate" href="https://www.dgl.ai/feed.xml" title="Deep Graph Library" />

    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="//oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-132455605-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-132455605-1');
</script>

    
</head>
  
<body>
    <!-- Preloader starts-->
    <div class="preloader">
        <div class="loading-center">
            <div class="loading-center-absolute">
                <div class="object object_one"></div>
                <div class="object object_two"></div>
                <div class="object object_three"></div>
            </div>
        </div>
    </div>
    <!-- Preloader ends -->
    <!-- Start Header -->
    <header>
      <!-- Start Mainmenu -->
<div class="menu-area navbar-fixed-top ">
    <div class="container">
        <div class="row">
            <div class="mainmenu-wrapper">
                <!-- Start Header Logo -->
                <div class="col-xs-12 col-md-3">
                    <div class="header-logo">
                        <a href="https://www.dgl.ai"><img src="/assets/images/logo.png" alt="logo"></a>
                    </div>
                </div>
                <!-- End Header Logo -->
                <!-- Start Navigation -->
                <div class="col-xs-12 col-md-9">
                    <div class="mainmenu">
                        <div class="navbar navbar-right">
                            <div class="navbar-header visible-xs">
                                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                                    <span class="sr-only">Toggle navigation</span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                </button>
                            </div>
                            <div class="collapse navbar-collapse top-menu">

                           <!--  Static Dropdown Menu 

                                <nav>
                                    <ul class="nav navbar-nav">
                                        <li class="active"><a href="https://www.dgl.ai">Home<span>Get everything</span></a>
                                           <ul class="dropdown">
                                               <li><a href="index.html">Home Version 1</a></li>
                                               <li><a href="index-2.html">Home Version 2</a></li>
                                           </ul>                                                
                                        </li>
                                        <li><a href="about-us.html">About<span>Know about us</span></a></li>                                
                                        <li><a href="questions.html">Questions<span>Ask Your Question</span></a>
                                            <ul class="dropdown">
                                                <li>
                                                    <a href="questions.html"> <span><i class="fa fa-question-circle"></i></span>All Questions</a>
                                                </li>                                                       
                                                <li><a href="ask-question.html"><span><i class="fa  fa-question-circle-o"></i></span>Ask Questions</a></li>
                                                <li><a href="answers.html"><span><i class="fa fa-reply-all"></i></span>Answers</a></li>
                                                <li><a href="login.html"><span><i class="fa fa-sign-in"></i></span>Login</a></li>
                                                <li><a href="register.html"><span><i class="fa fa-registered"></i></span>Register</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#">Pages<span>See All Pages</span></a>
                                           <ul class="dropdown">
                                               <li><a href="index-2.html">Home 2</a></li>
                                               <li><a href="blog.html">Blog</a></li>
                                               <li><a href="blog-details.html">Blog Details</a></li>
                                               <li><a href="questions.html">Questions</a></li>
                                               <li><a href="answers.html">Answers</a></li>
                                               <li><a href="updates.html">Updates</a></li>
                                               <li><a href="contact.html">Contact</a></li>
                                               <li><a href="left-sidebar.html">Left Sidebar</a></li>
                                               <li><a href="right-sidebar.html">Right Sidebar</a></li>
                                               <li><a href="login.html">login</a></li>
                                               <li><a href="register.html">Register</a></li>
                                               <li><a href="404.html">404</a></li>
                                           </ul>
                                        </li>
                                        <li><a href="blog.html">Blog<span>All Blog Posts</span></a></li>
                                        <li><a href="updates.html">Updates<span>Latest releases</span></a></li>
                                        <li><a href="contact.html">Contact<span>Let us contact</span></a></li>
                                    </ul>
                                </nav> 

                                End Static Dropdown Menu -->

                                <nav>
                                    <ul class="nav navbar-nav">
                                    
                                    
                                    
                                    
                                     <li>
                                        <a href="/pages/about.html">about
                                          <!--<span>About DGL</span>-->
                                        </a>
                                     </li>
                                    
                                    
                                    
                                    
                                    
                                     <li>
                                        <a href="/pages/start.html">Get Started
                                          <!--<span>Install</span>-->
                                        </a>
                                     </li>
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                     <li>
                                        <a href="https://docs.dgl.ai/tutorials/models/index.html">Tutorials
                                        </a>
                                     </li>
                                     <li>
                                        <a href="/pages/index.html">Blog
                                        </a>
                                     </li>
                                     <li>
                                        <a href="https://docs.dgl.ai">Docs
                                        </a>
                                     </li>
                                     <li>
                                        <a href="https://discuss.dgl.ai">Forum
                                        </a>
                                     </li>
                                     <li>
                                        <a href="https://github.com/dmlc/dgl">GitHub
                                        </a>
                                     </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Navigation -->
            </div>
        </div>
    </div>
</div>
<!-- End Mainmenu -->
<!-- Start Mobile Menu Area -->
<div class="col-xs-12 visible-xs">
    <div class="mobile-menu">
        <nav>
            <ul>
                <li><a href="/index.html">Home</a></li>
                <li><a href="https://docs.dgl.ai/#get-started">Get Started</a></li>
                <li><a href="/pages/about.html">About</a></li>
                <!--
                <li><a href="#">Questions</a>
                    <ul>
                        <li><a href="questions.html"> Questions</a></li>
                        <li><a href="ask-question.html">Ask Questions</a></li>
                        <li><a href="answers.html">Answers</a></li>
                        <li><a href="login.html">Login</a></li>
                        <li><a href="register.html">Register</a></li>                               
                    </ul>
                </li>
                <li><a href="#">Pages</a>
                    <ul>
                       <li><a href="blog.html">Blog</a></li>
                       <li><a href="blog-details.html">Blog Details</a></li>
                       <li><a href="questions.html">Questions</a></li>
                       <li><a href="answers.html">Answers</a></li>
                       <li><a href="updates.html">Updates</a></li>
                       <li><a href="contact.html">Contact</a></li>
                       <li><a href="left-sidebar.html">Left Sidebar</a></li>
                       <li><a href="right-sidebar.html">Right Sidebar</a></li>
                       <li><a href="login.html">login</a></li>
                       <li><a href="register.html">Register</a></li>
                       <li><a href="404.html">404</a></li>                          
                    </ul>
                </li>                       
                -->
                <li><a href="https://docs.dgl.ai/tutorials/models/index.html">Tutorials</a></li>
                <li><a href="/pages/index.html">Blog</a></li>
                <li><a href="https://docs.dgl.ai">Documents</a></li>
                <li><a href="/pages/updates.html">Updates</a></li>
                <li><a href="https://discuss.dgl.ai">Forum</a></li>
                <li><a href="https://github.com/dmlc/dgl">GitHub</a></li>
            </ul>
        </nav>
    </div>
</div>
<!-- End MObile Menu Area

   </header>
    <!-- End Header -->
<!-- Start Page Banner Area -->
<div class="page-banner-area">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="page-title">
          <h2>Blog Details</h2>
          <span class="sub-title"><a href="https://www.dgl.ai">Home</a> / Blog Details</span>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- End Pages Banner Area -->

<!-- Start Blog Area -->
<section class="blog-area themeix-ptb">
  <div class="container">
    <div class="row">
      <!-- Start Blog Content -->
      <div class="col-md-12">
        <div class="blog-wrapper">

          <div class="single-blog-details">
            <div class="blog-img">
              <img src="https://data.dgl.ai/tutorial/gat/cora-attention.png" alt="blog">
            </div>
            <div class="blog-content-desc">
              <h4 class="themeix-blog-h">Understand Graph Attention Network</h4>
              <p><p>From <a href="https://arxiv.org/abs/1609.02907">Graph Convolutional Network (GCN)</a>, we
learned that combining local graph structure and node-level features yields
good performance on node classification task. However, the way GCN aggregates
is structure-dependent, which may hurt its generalizability.</p>

<p>One workaround is to simply average over all neighbor node features as in
<a href="https://www-cs-faculty.stanford.edu/people/jure/pubs/graphsage-nips17.pdf">GraphSAGE</a>.
<a href="https://arxiv.org/abs/1710.10903">Graph Attention Network</a> proposes an
alternative way by weighting neighbor features with feature dependent and
structure free normalization, in the style of attention.</p>

<p>The goal of this tutorial:</p>
<ul>
  <li>Explain what is Graph Attention Network.</li>
  <li>Demonstrate how it can be implemented in DGL.</li>
  <li>Understand the attentions learnt.</li>
  <li>Introduce to inductive learning.</li>
</ul>

<h2 id="introducing-attention-to-gcn">Introducing Attention to GCN</h2>

<p>The key difference between GAT and GCN is how the information from the one-hop
neighborhood is aggregated.</p>

<p>For GCN, a graph convolution operation produces the normalized sum of the node
features of neighbors:</p>

<script type="math/tex; mode=display">h_i^{(l+1)}=\sigma\left(\sum_{j\in \mathcal{N}(i)} {\frac{1}{c_{ij}} W^{(l)}h^{(l)}_j}\right),</script>

<p>where <script type="math/tex">\mathcal{N}(i)</script> is the set of its one-hop neighbors (to include <script type="math/tex">v_i</script> in
the set, simply add a self-loop to each node),
<script type="math/tex">c_{ij}=\sqrt{|\mathcal{N}(i)|}\sqrt{|\mathcal{N}(j)|}</script> is a normalization
constant based on graph structure, <script type="math/tex">\sigma</script> is an activation function (GCN uses
<script type="math/tex">\text{ReLU}</script>), and <script type="math/tex">W^{(l)}</script> is a shared weight matrix for node-wise feature
transformation. Another model proposed in
<a href="https://www-cs-faculty.stanford.edu/people/jure/pubs/graphsage-nips17.pdf">GraphSAGE</a>
employs the same update rule except that they set <script type="math/tex">c_{ij}=|\mathcal{N}(i)|</script>.</p>

<p>GAT introduces the attention mechanism as a substitute for the statically
normalized convolution operation. Below are the equations to compute the node
embedding <script type="math/tex">h_i^{(l+1)}</script> of layer <script type="math/tex">l+1</script> from the embeddings of layer <script type="math/tex">l</script>:</p>

<p><img src="https://data.dgl.ai/tutorial/gat/gat.png" alt="" width="450x" class="aligncenter" /></p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
z_i^{(l)}&=W^{(l)}h_i^{(l)},&(1)\\
e_{ij}^{(l)}&=\text{LeakyReLU}(\vec a^{(l)^T}(z_i^{(l)}\|z_j^{(l)})),&(2)\\
\alpha_{ij}^{(l)}&=\frac{\exp(e_{ij}^{(l)})}{\sum_{k\in \mathcal{N}(i)}^{}\exp(e_{ik}^{(l)})},&(3)\\
h_i^{(l+1)}&=\sigma\left(\sum_{j\in \mathcal{N}(i)} {\alpha^{(l)}_{ij} z^{(l)}_j }\right),&(4)
\end{align} %]]></script>

<p>Explanations:</p>
<ul>
  <li>Equation (1) is a linear transformation of the lower layer embedding
<script type="math/tex">h_i^{(l)}</script> and <script type="math/tex">W^{(l)}</script> is its learnable weight matrix.</li>
  <li>Equation (2) computes a pair-wise <em>unnormalized</em> attention score between two
neighbors. Here, it first concatenates the <script type="math/tex">z</script> embeddings of the two nodes,
where <script type="math/tex">\|</script> denotes concatenation, then takes a dot product of it and a
learnable weight vector <script type="math/tex">\vec a^{(l)}</script>, and applies a LeakyReLU in the end.
This form of attention is usually called <em>additive attention</em>, contrast with
the dot-product attention in the Transformer model.</li>
  <li>Equation (3) applies a softmax to normalize the attention scores on each
node’s in-coming edges.</li>
  <li>Equation (4) is similar to GCN. The embeddings from neighbors are aggregated
together, scaled by the attention scores.</li>
</ul>

<p>There are other details from the paper, such as dropout and skip connections.
For the purpose of simplicity, we omit them in this tutorial and leave the link
to the full example at the end for interested readers.</p>

<p>In its essence, GAT is just a different aggregation function with attention
over features of neighbors, instead of a simple mean aggregation.</p>

<h2 id="gat-in-dgl">GAT in DGL</h2>
<p>Let’s first have an overall impression about how a <code class="highlighter-rouge">GATLayer</code> module is
implemented in DGL. Don’t worry, we will break down the four equations above
one-by-one.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="kn">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="kn">as</span> <span class="nn">F</span>

<span class="k">class</span> <span class="nc">GATLayer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">in_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GATLayer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">g</span>
        <span class="c"># equation (1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># equation (2)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attn_fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">out_dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">edge_attention</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
        <span class="c"># edge UDF for equation (2)</span>
        <span class="n">z2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">edges</span><span class="o">.</span><span class="n">src</span><span class="p">[</span><span class="s">'z'</span><span class="p">],</span> <span class="n">edges</span><span class="o">.</span><span class="n">dst</span><span class="p">[</span><span class="s">'z'</span><span class="p">]],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attn_fc</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">'e'</span> <span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">leaky_relu</span><span class="p">(</span><span class="n">a</span><span class="p">)}</span>
    
    <span class="k">def</span> <span class="nf">message_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
        <span class="c"># message UDF for equation (3) &amp; (4)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">'z'</span> <span class="p">:</span> <span class="n">edges</span><span class="o">.</span><span class="n">src</span><span class="p">[</span><span class="s">'z'</span><span class="p">],</span> <span class="s">'e'</span> <span class="p">:</span> <span class="n">edges</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">'e'</span><span class="p">]}</span>
    
    <span class="k">def</span> <span class="nf">reduce_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">):</span>
        <span class="c"># reduce UDF for equation (3) &amp; (4)</span>
        <span class="c"># equation (3)</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">mailbox</span><span class="p">[</span><span class="s">'e'</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c"># equation (4)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">nodes</span><span class="o">.</span><span class="n">mailbox</span><span class="p">[</span><span class="s">'z'</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">'h'</span> <span class="p">:</span> <span class="n">h</span><span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
        <span class="c"># equation (1)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s">'z'</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>
        <span class="c"># equation (2)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">apply_edges</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edge_attention</span><span class="p">)</span>
        <span class="c"># equation (3) &amp; (4)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">update_all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message_func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce_func</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">'h'</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="equation-1">Equation (1)</h3>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
z_i^{(l)}&=W^{(l)}h_i^{(l)},&(1)
\end{align} %]]></script>

<p>The first one is simple. Linear transformation is very common and can be easily
implemented in Pytorch using <code class="highlighter-rouge">torch.nn.Linear</code>.</p>

<h3 id="equation-2">Equation (2)</h3>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
e_{ij}^{(l)}&=\text{LeakyReLU}(\vec a^{(l)^T}(z_i^{(l)}\|z_j^{(l)})),&(2)
\end{align} %]]></script>

<p>The unnormalized attention score <script type="math/tex">e_{ij}</script> is calculated using the embeddings of
adjacent nodes <script type="math/tex">i</script> and <script type="math/tex">j</script>. This suggests that the attention scores can be
viewed as edge data which can be calculated by the <code class="highlighter-rouge">apply_edges</code> API. The
argument to the <code class="highlighter-rouge">apply_edges</code> is an <strong>Edge UDF</strong>, which is defined as below:</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code>    <span class="k">def</span> <span class="nf">edge_attention</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
        <span class="c"># edge UDF for equation (2)</span>
        <span class="n">z2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">edges</span><span class="o">.</span><span class="n">src</span><span class="p">[</span><span class="s">'z'</span><span class="p">],</span> <span class="n">edges</span><span class="o">.</span><span class="n">dst</span><span class="p">[</span><span class="s">'z'</span><span class="p">]],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attn_fc</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">'e'</span> <span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">leaky_relu</span><span class="p">(</span><span class="n">a</span><span class="p">)}</span>
</code></pre>
</div>
<p>Here, the dot product with the learnable weight vector <script type="math/tex">\vec a^{(l)}</script> is
implemented again using pytorch’s linear transformation <code class="highlighter-rouge">attn_fc</code>. Note that
<code class="highlighter-rouge">apply_edges</code> will <strong>batch</strong> all the edge data in one tensor, so the <code class="highlighter-rouge">cat</code>,
<code class="highlighter-rouge">attn_fc</code> here are applied on all the edges in parallel.</p>

<h3 id="equation-3--4">Equation (3) &amp; (4)</h3>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\alpha_{ij}^{(l)}&=\frac{\exp(e_{ij}^{(l)})}{\sum_{k\in \mathcal{N}(i)}^{}\exp(e_{ik}^{(l)})},&(3)\\
h_i^{(l+1)}&=\sigma\left(\sum_{j\in \mathcal{N}(i)} {\alpha^{(l)}_{ij} z^{(l)}_j }\right),&(4)
\end{align} %]]></script>

<p>Similar to GCN, <code class="highlighter-rouge">update_all</code> API is used to trigger message passing on all the
nodes. The message function sends out two tensors: the transformed <code class="highlighter-rouge">z</code>
embedding of the source node and the unnormalized attention score <code class="highlighter-rouge">e</code> on each
edge. The reduce function then performs two tasks:</p>

<ol>
  <li>Normalize the attention scores using softmax (equation (3)).</li>
  <li>Aggregate neighbor embeddings weighted by the attention scores (equation(4)).</li>
</ol>

<p>Both tasks first fetch data from the mailbox and then manipulate it on the
second dimension (<code class="highlighter-rouge">dim=1</code>), on which the messages are batched.</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code>    <span class="k">def</span> <span class="nf">reduce_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">):</span>
        <span class="c"># reduce UDF for equation (3) &amp; (4)</span>
        <span class="c"># equation (3)</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">mailbox</span><span class="p">[</span><span class="s">'e'</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c"># equation (4)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">nodes</span><span class="o">.</span><span class="n">mailbox</span><span class="p">[</span><span class="s">'z'</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">'h'</span> <span class="p">:</span> <span class="n">h</span><span class="p">}</span>
</code></pre>
</div>

<h3 id="multi-head-attention">Multi-head Attention</h3>

<p>Analogous to multiple channels in ConvNet, GAT introduces <strong>multi-head
attention</strong> to enrich the model capacity and to stabilize the learning process.
Each attention head has its own parameters and their outputs can be merged in
two ways:</p>

<script type="math/tex; mode=display">\text{concatenation}: h^{(l+1)}_{i} =\|_{k=1}^{K}\sigma\left(\sum_{j\in \mathcal{N}(i)}\alpha_{ij}^{k}W^{k}h^{(l)}_{j}\right)</script>

<p>or</p>

<script type="math/tex; mode=display">\text{average}: h_{i}^{(l+1)}=\sigma\left(\frac{1}{K}\sum_{k=1}^{K}\sum_{j\in\mathcal{N}(i)}\alpha_{ij}^{k}W^{k}h^{(l)}_{j}\right)</script>

<p>where <script type="math/tex">K</script> is the number of heads. The authors suggest using concatenation for
intermediary layers and average for the final layer.</p>

<p>We can use the above defined single-head <code class="highlighter-rouge">GATLayer</code> as the building block for
the <code class="highlighter-rouge">MultiHeadGATLayer</code> below:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MultiHeadGATLayer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">in_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">,</span> <span class="n">merge</span><span class="o">=</span><span class="s">'cat'</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MultiHeadGATLayer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heads</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_heads</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GATLayer</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">in_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">merge</span> <span class="o">=</span> <span class="n">merge</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
        <span class="n">head_outs</span> <span class="o">=</span> <span class="p">[</span><span class="n">attn_head</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">attn_head</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">heads</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">merge</span> <span class="o">==</span> <span class="s">'cat'</span><span class="p">:</span>
            <span class="c"># concat on the output feature dimension (dim=1)</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">head_outs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># merge using average</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">head_outs</span><span class="p">))</span>
</code></pre>
</div>

<h3 id="put-everything-together">Put everything together</h3>

<p>Now, we can define a two-layer GAT model:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">GAT</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">in_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GAT</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer1</span> <span class="o">=</span> <span class="n">MultiHeadGATLayer</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">in_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">)</span>
        <span class="c"># Be aware that the input dimension is hidden_dim*num_heads since</span>
        <span class="c">#   multiple head outputs are concatenated together. Also, only</span>
        <span class="c">#   one attention head in the output layer.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer2</span> <span class="o">=</span> <span class="n">MultiHeadGATLayer</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">hidden_dim</span> <span class="o">*</span> <span class="n">num_heads</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer1</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">elu</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer2</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">h</span>
</code></pre>
</div>

<p>We then load the cora dataset using DGL’s built-in data module.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">dgl</span> <span class="kn">import</span> <span class="n">DGLGraph</span>
<span class="kn">from</span> <span class="nn">dgl.data</span> <span class="kn">import</span> <span class="n">citation_graph</span> <span class="k">as</span> <span class="n">citegrh</span>

<span class="k">def</span> <span class="nf">load_cora_data</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">citegrh</span><span class="o">.</span><span class="n">load_cora</span><span class="p">()</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">features</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">LongTensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ByteTensor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">train_mask</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">DGLGraph</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">g</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">mask</span>
</code></pre>
</div>

<p>The training loop is exactly the same as in the GCN tutorial.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">g</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">load_cora_data</span><span class="p">()</span>

<span class="c"># create the model</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">GAT</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> 
          <span class="n">in_dim</span><span class="o">=</span><span class="n">features</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> 
          <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> 
          <span class="n">out_dim</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> 
          <span class="n">num_heads</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>

<span class="c"># create optimizer</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>

<span class="c"># main loop</span>
<span class="n">dur</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">epoch</span> <span class="o">&gt;=</span><span class="mi">3</span><span class="p">:</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        
    <span class="n">logits</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
    <span class="n">logp</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">logp</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
    
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">epoch</span> <span class="o">&gt;=</span><span class="mi">3</span><span class="p">:</span>
        <span class="n">dur</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s">"Epoch {:05d} | Loss {:.4f} | Time(s) {:.4f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">epoch</span><span class="p">,</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dur</span><span class="p">)))</span>
</code></pre>
</div>

<h2 id="visualizing-and-understanding-attention-learnt">Visualizing and Understanding Attention Learnt</h2>

<h3 id="cora">Cora</h3>

<p>The following table summarizes the model performances on Cora reported in <a href="https://arxiv.org/pdf/1710.10903.pdf">the
GAT paper</a> and obtained with dgl
implementations.</p>

<table>
  <thead>
    <tr>
      <th>Model</th>
      <th>Accuracy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GCN (paper)</td>
      <td><script type="math/tex">81.4\pm 0.5</script>%</td>
    </tr>
    <tr>
      <td>GCN (dgl)</td>
      <td><script type="math/tex">82.05\pm 0.33</script>%</td>
    </tr>
    <tr>
      <td>GAT (paper)</td>
      <td><script type="math/tex">83.0\pm 0.7</script>%</td>
    </tr>
    <tr>
      <td>GAT (dgl)</td>
      <td><script type="math/tex">83.69\pm 0.529</script>%</td>
    </tr>
  </tbody>
</table>

<p><em>What kind of attention distribution has our model learnt?</em></p>

<p>Because the attention weight <script type="math/tex">a_{ij}</script> is associated with edges, we can
visualize it by coloring edges. Below we pick a subgraph of Cora and plot the
attention weights of the last <code class="highlighter-rouge">GATLayer</code>. The nodes are colored according to
their labels, whereas the edges are colored according to the magnitude of the
attention weights, which can be referred with the colorbar on the right.</p>

<p><img src="https://data.dgl.ai/tutorial/gat/cora-attention.png" alt="" class="aligncenter" /></p>

<p>You can that the model seems to learn different attention weights. To
understand the distribution more thoroughly, we measure the
<a href="https://en.wikipedia.org/wiki/Entropy_(information_theory)">entropy</a> of the
attention distribution. For any node <script type="math/tex">i</script>,
<script type="math/tex">\{\alpha_{ij}\}_{j\in\mathcal{N}(i)}</script> forms a discrete probability
distribution over all its neighbors with the entropy given by</p>

<script type="math/tex; mode=display">H(\{\alpha_{ij}\}_{j\in\mathcal{N}(i)})=-\sum_{j\in\mathcal{N}(i)} \alpha_{ij}\log\alpha_{ij}</script>

<p>Intuitively, a low entropy means a high degree of concentration, and vice
versa; an entropy of 0 means all attention is on one source node. The uniform
distribution has the highest entropy of <script type="math/tex">\log(\mathcal{N}(i))</script>. Ideally, we
want to see the model learns a distribution of lower entropy (i.e, one or two
neighbors are much more important than the others).</p>

<p>Note that since nodes can have different degrees, the maximum entropy will also
be different. Therefore, we plot the aggregated histogram of entropy values of
all nodes in the entire graph. Below are the attention histogram of learned by
each attention head.</p>

<p><img src="https://data.dgl.ai/tutorial/gat/cora-attention-hist.png" alt="" /></p>

<p>As a reference, here is the histogram if all the nodes have uniform attention weight distribution.</p>

<p><img src="https://data.dgl.ai/tutorial/gat/cora-attention-uniform-hist.png" alt="" width="400x" class="aligncenter" /></p>

<p>One can see that <strong>the attention values learned is quite similar to uniform
distribution</strong> (i.e, all neighbors are equally important). This partially
explains why the performance of GAT is close to that of GCN on Cora (according
to <a href="https://arxiv.org/pdf/1710.10903.pdf">author’s reported result</a>, the
accuracy difference averaged over <script type="math/tex">100</script> runs is less than <script type="math/tex">2</script>%); attention does
not matter since it does not differentiate much any ways.</p>

<p><em>Does that mean the attention mechanism is not useful?</em> No! A different dataset
exhibits an entirely different pattern, as we show next.</p>

<h3 id="protein-protein-interaction-ppi-networks">Protein-Protein Interaction (PPI) networks</h3>

<p>The PPI dataset used here consists of <script type="math/tex">24</script> graphs corresponding to different
human tissues. Nodes can have up to <script type="math/tex">121</script> kinds of labels, so the label of node
is represented as a binary tensor of size <script type="math/tex">121</script>. The task is to predict node
label.</p>

<p>We use <script type="math/tex">20</script> graphs for training, <script type="math/tex">2</script> for validation and <script type="math/tex">2</script> for test. The
average number of nodes per graph is <script type="math/tex">2372</script>. Each node has <script type="math/tex">50</script> features that
are composed of positional gene sets, motif gene sets and immunological
signatures. Critically, test graphs remain completely unobserved during
training, a setting called “inductive learning”.</p>

<p>We compare the performance of GAT and GCN for <script type="math/tex">10</script> random runs on this task and
use hyperparameter search on the validation set to find the best model.</p>

<table>
  <thead>
    <tr>
      <th>Model</th>
      <th>F1 Score(micro)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GAT</td>
      <td><script type="math/tex">0.975 \pm 0.006</script></td>
    </tr>
    <tr>
      <td>GCN</td>
      <td><script type="math/tex">0.509 \pm 0.025</script></td>
    </tr>
    <tr>
      <td>Paper</td>
      <td><script type="math/tex">0.973 \pm 0.002</script></td>
    </tr>
  </tbody>
</table>

<p>The table above is the result of this experiment, where we use micro <a href="https://en.wikipedia.org/wiki/F1_score">F1
score</a> to evaluate the model
performance.</p>

<p>During training, we use <code class="highlighter-rouge">BCEWithLogitsLoss</code> as the loss function. The learning
curves of GAT and GCN are presented below; what is evident is the dramatic
performance adavantage of GAT over GCN.</p>

<p><img src="https://data.dgl.ai/tutorial/gat/ppi-curve.png" alt="ppi-curve" width="500x" class="aligncenter" /></p>

<p>As before, we can have a statistical understanding of the attentions learnt by
showing the histogram plot for the node-wise attention entropy. Below are the
attention histogram learnt by different attention layers.</p>

<p><em>Attention learnt in layer 1:</em></p>

<p><img src="https://data.dgl.ai/tutorial/gat/ppi-first-layer-hist.png" alt="" width="600px" class="aligncenter" /></p>

<p><em>Attention learnt in layer 2:</em></p>

<p><img src="https://data.dgl.ai/tutorial/gat/ppi-second-layer-hist.png" alt="" width="600px" class="aligncenter" /></p>

<p><em>Attention learnt in final layer:</em></p>

<p><img src="https://data.dgl.ai/tutorial/gat/ppi-final-layer-hist.png" alt="" width="600px" class="aligncenter" /></p>

<p>Again, comparing with uniform distribution:</p>

<p><img src="https://data.dgl.ai/tutorial/gat/ppi-uniform-hist.png" alt="" width="300px" class="aligncenter" /></p>

<p>Clearly, <strong>GAT does learn sharp attention weights</strong>! There is a clear pattern
over the layers as well: <strong>the attention gets more sharper with higher layer</strong>.</p>

<p>Unlike the Cora dataset where GAT’s gain is lukewarm at best, for PPI there is
a significant performance gap between GAT and other GNN variants compared in
<a href="https://arxiv.org/pdf/1710.10903.pdf">the GAT paper</a> (at least <script type="math/tex">20</script>%), and the
attention distributions between the two clearly differ. While this deserves
further research, one immediate conclusion is that GAT’s advantage lies perhaps
more in its ability to handle a graph with more complex neighborhood structure.</p>

<h2 id="whats-next">What’s Next?</h2>

<p>So far, we demonstrated how to use DGL to implement GAT. There are some missing
details such as dropout, skip connections and hyper-parameter tuning, which are
common practices and do not involve DGL-related concepts. We refer interested
readers to the full example.</p>

<ul>
  <li>See the optimized full example
<a href="https://github.com/dmlc/dgl/blob/master/examples/pytorch/gat/gat.py">here</a>.</li>
  <li>Stay tune for our next tutorial about how to speedup GAT models by
parallelizing multiple attention heads and SPMV optimization.</li>
</ul>
</p>
              <div class="blog-post-date">
                <p>17 <span>February</span> </p>
              </div>
              <div class="tag-links mt-30">
                <div class="widget">
                  <div class="tagcloud">
                    <a href="/tag/blog.html" class="set-4">blog</a> <a href="/tag/news.html" class="set-3">news</a> <a href="/tag/release.html" class="set-5">release</a>
                  </div>
                </div>
                <div class="blog-data">
                  <p>By 
                  
                  <a href="https://github.com/sufeidechabei/">Hao Zhang</a>,
                  
                  <a href="https://github.com/mufeili">Mufei Li</a>,
                  
                  <a href="https://jermainewang.github.io/">Minjie Wang</a>,
                  
                  <a href="https://shanghai.nyu.edu/academics/faculty/directory/zheng-zhang">Zheng Zhang</a>,
                   in <a href="#">blog</a> </p>
                </div>
              </div>
              <!-- Leave a Comment -->
              <div id="respond">
                <div class="comment-respond pb-50">
                  <div id='discourse-comments'></div>
                  <script type="text/javascript">
  DiscourseEmbed = { discourseUrl: 'https://discuss.dgl.ai/',
                     discourseEmbedUrl: 'https://www.dgl.ai/blog/2019/02/17/gat.html' };

  (function() {
    var d = document.createElement('script'); d.type = 'text/javascript'; d.async = true;
    d.src = DiscourseEmbed.discourseUrl + 'javascripts/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(d);
  })();
</script>

                </div>
              </div>
              <!-- End Leave a Comment -->
            </div>
          </div>
        </div>
      </div>
      <!-- End Blog Content -->
      <!-- Start Blog Sidebar -->
      <!--
      <div class="col-md-3">
        <div class="row">
          <div class="blog-sidebar">
            <div class="col-md-12 col-sm-6">
              <aside id="dwqa-categories-2" class="widget widget_categories dwqa_widget dwqa_widget_categories sidebar-list">
                <h4 class="list-title">Categories</h4>
<ul>
	
	
    
	 <li><a href="topics/AngularJS">AngularJS</a></li> 
	

</ul>



              </aside>
            </div>
            <div class="col-md-12 col-sm-6">
              <aside class="widget dwqa-widget dwqa-popular-question">
                <div class="sidebar-popular-post dwqa-popular-questions">
                  <div class="popular-questions"> 
<h2 class="widget-title">Popular Questions</h2>
<ul>

    

    
     <li><a href="/category_one/question_two">Can I Start Learning AngularJS Framework ?</a></li>
    
     <li><a href="/category_one/question_one">What is AngularJS ?</a></li>
    

    
    
     <li><a href="/category_two/question_three">How Can I Learning ReactJS Framework ?</a></li>
    
     <li><a href="/category_two/question_two">How Can I Learning ReactJS Framework ?</a></li>
    

    
    
     <li><a href="/category_three/question_three">Can I Learning EmberJS Framework ?</a></li>
    
     <li><a href="/category_three/question_two">How Can I Learning EmberJS Framework ?</a></li>
    

    
    
     <li><a href="/category_four/question_one">What is VueJS ?</a></li>
    
     <li><a href="/category_four/question_two">How Can I Learning VueJS Framework ?</a></li>
    

 </ul>
</div>
                </div>
              </aside>
            </div>
          </div>
        </div>
      </div>
      -->
      <!-- End Blog Sidebar -->
    </div>
  </div>
</section>
<!-- End Blog Area -->


    <!-- Start Footer Area -->
    <footer>
        <div class="footer-area themeix-ptb">
            <div class="container">
                <div class="row">
                    <div class="footer-wrapper">
                        <div class="col-sm-6 col-md-3">
                            <div class="single-footer">
                                <h3 class="footer-heading">Follow Us</h3>
                                <div class="single-footer-text">
                                    <p>Keep track the latest news, blogs and updates of DGL by following our social media accounts.</p>
                                </div>
                                <div class="social-links">
                                    <ul>
                                        <li><a href="https://twitter.com/GraphDeep"><i class="fa fa-twitter"></i></a></li>
                                        <li class="fb-link"><a href="https://www.facebook.com/GraphDeep/"><i class="fa fa-facebook"></i></a></li>
                                        <li><a href="/feed.xml"><i class="fa fa-rss"></i></a></li>
                                        <!--<li class="gp-link"><a href="#"><i class="fa fa-google-plus"></i></a></li>-->
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="single-footer">
                                <h3 class="footer-heading">Quick Links</h3>
                                <div class="footer-list">
                                    <ul>
                                        <li><a href="/pages/about.html">About us</a></li>
                                        <li><a href="/pages/start.html">Get started</a></li>
                                        <li><a href="https://github.com/dmlc/dgl/releases">Latest updates</a></li>
                                        <li><a href="/pages/index.html">Blogs</a></li>
                                        <li><a href="https://github.com/dmlc/dgl/">Github</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="single-footer">
                                <h3 class="footer-heading">Materials</h3>
                                <div class="footer-list">
                                    <ul>
                                        <li><a href="https://docs.dgl.ai/tutorials/models/index.html">Tutorials</a></li>
                                        <li><a href="https://discuss.dgl.ai">Discuss forum</a></li>
                                        <li><a href="https://github.com/dmlc/dgl/issues">Github issues</a></li>
                                        <li><a href="https://github.com/dmlc/dgl/blob/master/CONTRIBUTORS.md">Contributing</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="single-footer">
                                <h3 class="footer-heading">Contact Us</h3>
                                <div class="subscribe-form">
                                    <form action="https://formspree.io/f/maylbdvy" method="POST">
                                        <input type="text" name="name" id="name" class="form-control" placeholder="Name" required>
                                        <input type="text" name="message" id="message" class="form-control" placeholder="Message" required>
                                        <input type="email" name="_replyto" id="email" class="form-control" placeholder="Email" required>
                                        <button type="submit" class="hover-bg">Submit</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Start Footer Bottom Area -->
        <!--
        <div class="footer-bottom-area themeix-pb">
            <div class="container">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="footer-bottom">
                            <div class="footer-logo">
                                <a href="#"><img src="/assets/images/footer-logo.png" alt="logo"></a>
                            </div>
                            <div class="footer-links">
                                <ul>
                                    <li><a href="#">Privacy Policy</a></li>
                                    <li><a href="#">Refund Policy</a></li>
                                    <li><a href="#">Disclaimer</a></li>
                                </ul>
                            </div>
                            <div class="copyright-text">
                                <p>All content Documenter &copy; 2017 - All rights reserved. - Proudly made with <a href="http://designingmarket.com">Designing Market</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        -->
        <!-- End Footer Bottom Area -->
        <!-- Start Scroll To Top -->
        <div class="scroll-top">
            <div class="scroll-icon">
                <i class="fa fa-angle-up"></i>
            </div>
        </div>
        <!-- End Scroll To Top -->
    </footer>
    <!-- End Footer Area -->

    <!-- jquery min -->
    <script src="/assets/js/jquery.min.js"></script>

    <!-- Bootstrap Js -->
    <script src="/assets/js/bootstrap.min.js"></script>

    <!-- jQuery Easing -->
    <script src="/assets/js/jquery.easing.js"></script>

    <!-- Owl Carousel Js -->
    <script src="/assets/js/owl.carousel.min.js"></script>

    <!-- Google Map -->
    <!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAOCx7VEftKaGSK2F2p_tUKmMSdN00palo"></script> -->

    <!-- Mean Menu -->
    <script src="/assets/js/jquery.meanmenu.js"></script>

    <!-- Particles JS CDN -->
    <script src="/assets/js/particles.min.js"></script> 

    <!-- Main Js -->
    <script src="/assets/js/main.js"></script>

    <!-- MathJax Js -->
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
</body>

</html>
