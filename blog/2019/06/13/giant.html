<head>
    <!-- meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Library for deep learning on graphs">
    <meta name="keywords" content="Software, Machine Learning, Deep Learning, Neural Network, Graph">
    <meta name="author" content="Themeix">

    <!-- Site Title -->
    <title>Deep Graph Library</title>

    <!-- favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/assets/images/dgl-favicon.png">

    <!-- IView CSS -->
    <link rel="stylesheet" href="//unpkg.com/iview/dist/styles/iview.css">

    <!-- Bootstrap CSS -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font-Awesome CSS -->
    <link href="/assets/css/font-awesome.min.css" rel="stylesheet">

    <!-- Google Fonts -->
    <link href="/assets/css/googlefont.css" rel="stylesheet"> 

    <!-- Animate CSS -->
    <link rel="stylesheet" href="/assets/css/animate.min.css">

    <!-- Owl Carousel CSS -->
    <link rel="stylesheet" href="/assets/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/assets/css/owl.theme.default.min.css">
    <!--<link rel="stylesheet" href="/assets/css/owl.carousel.min.css">-->

    <!-- Mean Menu CSS -->
    <link rel="stylesheet" href="/assets/css/meanmenu.min.css">

    <!-- Main Stylesheet -->
    <link href="/assets/css/style.css" rel="stylesheet">

    <!-- Responsive CSS -->
    <link href="/assets/css/responsive.css" rel="stylesheet">

    <!-- Minima CSS -->
    <link href="/assets/main.css" rel="stylesheet">

    <!-- Rouge Highlighter CSS -->
    <link href="/assets/css/syntax.css" rel="stylesheet">

    <link type="application/atom+xml" rel="alternate" href="https://www.dgl.ai/feed.xml" title="Deep Graph Library" />

    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="//oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-132455605-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-132455605-1');
</script>

    
</head>
  
<body>
    <!-- Preloader starts-->
    <div class="preloader">
        <div class="loading-center">
            <div class="loading-center-absolute">
                <div class="object object_one"></div>
                <div class="object object_two"></div>
                <div class="object object_three"></div>
            </div>
        </div>
    </div>
    <!-- Preloader ends -->
    <!-- Start Header -->
    <header>
      <!-- Start Mainmenu -->
<div class="menu-area navbar-fixed-top ">
    <div class="container">
        <div class="row">
            <div class="mainmenu-wrapper">
                <!-- Start Header Logo -->
                <div class="col-xs-12 col-md-3">
                    <div class="header-logo">
                        <a href="https://www.dgl.ai"><img src="/assets/images/logo.png" alt="logo"></a>
                    </div>
                </div>
                <!-- End Header Logo -->
                <!-- Start Navigation -->
                <div class="col-xs-12 col-md-9">
                    <div class="mainmenu">
                        <div class="navbar navbar-right">
                            <div class="navbar-header visible-xs">
                                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                                    <span class="sr-only">Toggle navigation</span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                </button>
                            </div>
                            <div class="collapse navbar-collapse top-menu">

                           <!--  Static Dropdown Menu 

                                <nav>
                                    <ul class="nav navbar-nav">
                                        <li class="active"><a href="https://www.dgl.ai">Home<span>Get everything</span></a>
                                           <ul class="dropdown">
                                               <li><a href="index.html">Home Version 1</a></li>
                                               <li><a href="index-2.html">Home Version 2</a></li>
                                           </ul>                                                
                                        </li>
                                        <li><a href="about-us.html">About<span>Know about us</span></a></li>                                
                                        <li><a href="questions.html">Questions<span>Ask Your Question</span></a>
                                            <ul class="dropdown">
                                                <li>
                                                    <a href="questions.html"> <span><i class="fa fa-question-circle"></i></span>All Questions</a>
                                                </li>                                                       
                                                <li><a href="ask-question.html"><span><i class="fa  fa-question-circle-o"></i></span>Ask Questions</a></li>
                                                <li><a href="answers.html"><span><i class="fa fa-reply-all"></i></span>Answers</a></li>
                                                <li><a href="login.html"><span><i class="fa fa-sign-in"></i></span>Login</a></li>
                                                <li><a href="register.html"><span><i class="fa fa-registered"></i></span>Register</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#">Pages<span>See All Pages</span></a>
                                           <ul class="dropdown">
                                               <li><a href="index-2.html">Home 2</a></li>
                                               <li><a href="blog.html">Blog</a></li>
                                               <li><a href="blog-details.html">Blog Details</a></li>
                                               <li><a href="questions.html">Questions</a></li>
                                               <li><a href="answers.html">Answers</a></li>
                                               <li><a href="updates.html">Updates</a></li>
                                               <li><a href="contact.html">Contact</a></li>
                                               <li><a href="left-sidebar.html">Left Sidebar</a></li>
                                               <li><a href="right-sidebar.html">Right Sidebar</a></li>
                                               <li><a href="login.html">login</a></li>
                                               <li><a href="register.html">Register</a></li>
                                               <li><a href="404.html">404</a></li>
                                           </ul>
                                        </li>
                                        <li><a href="blog.html">Blog<span>All Blog Posts</span></a></li>
                                        <li><a href="updates.html">Updates<span>Latest releases</span></a></li>
                                        <li><a href="contact.html">Contact<span>Let us contact</span></a></li>
                                    </ul>
                                </nav> 

                                End Static Dropdown Menu -->

                                <nav>
                                    <ul class="nav navbar-nav">
                                    
                                    
                                    
                                    
                                     <li>
                                        <a href="/pages/about.html">about
                                          <!--<span>About DGL</span>-->
                                        </a>
                                     </li>
                                    
                                    
                                    
                                    
                                    
                                     <li>
                                        <a href="/pages/start.html">Get Started
                                          <!--<span>Install</span>-->
                                        </a>
                                     </li>
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                     <li>
                                        <a href="https://docs.dgl.ai/tutorials/models/index.html">Tutorials
                                        </a>
                                     </li>
                                     <li>
                                        <a href="/pages/index.html">Blog
                                        </a>
                                     </li>
                                     <li>
                                        <a href="https://docs.dgl.ai">Docs
                                        </a>
                                     </li>
                                     <li>
                                        <a href="https://discuss.dgl.ai">Forum
                                        </a>
                                     </li>
                                     <li>
                                        <a href="https://github.com/dmlc/dgl">GitHub
                                        </a>
                                     </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Navigation -->
            </div>
        </div>
    </div>
</div>
<!-- End Mainmenu -->
<!-- Start Mobile Menu Area -->
<div class="col-xs-12 visible-xs">
    <div class="mobile-menu">
        <nav>
            <ul>
                <li><a href="/index.html">Home</a></li>
                <li><a href="https://docs.dgl.ai/#get-started">Get Started</a></li>
                <li><a href="/pages/about.html">About</a></li>
                <!--
                <li><a href="#">Questions</a>
                    <ul>
                        <li><a href="questions.html"> Questions</a></li>
                        <li><a href="ask-question.html">Ask Questions</a></li>
                        <li><a href="answers.html">Answers</a></li>
                        <li><a href="login.html">Login</a></li>
                        <li><a href="register.html">Register</a></li>                               
                    </ul>
                </li>
                <li><a href="#">Pages</a>
                    <ul>
                       <li><a href="blog.html">Blog</a></li>
                       <li><a href="blog-details.html">Blog Details</a></li>
                       <li><a href="questions.html">Questions</a></li>
                       <li><a href="answers.html">Answers</a></li>
                       <li><a href="updates.html">Updates</a></li>
                       <li><a href="contact.html">Contact</a></li>
                       <li><a href="left-sidebar.html">Left Sidebar</a></li>
                       <li><a href="right-sidebar.html">Right Sidebar</a></li>
                       <li><a href="login.html">login</a></li>
                       <li><a href="register.html">Register</a></li>
                       <li><a href="404.html">404</a></li>                          
                    </ul>
                </li>                       
                -->
                <li><a href="https://docs.dgl.ai/tutorials/models/index.html">Tutorials</a></li>
                <li><a href="/pages/index.html">Blog</a></li>
                <li><a href="https://docs.dgl.ai">Documents</a></li>
                <li><a href="/pages/updates.html">Updates</a></li>
                <li><a href="https://discuss.dgl.ai">Forum</a></li>
                <li><a href="https://github.com/dmlc/dgl">GitHub</a></li>
            </ul>
        </nav>
    </div>
</div>
<!-- End MObile Menu Area

   </header>
    <!-- End Header -->
<!-- Start Page Banner Area -->
<div class="page-banner-area">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="page-title">
          <h2>Blog Details</h2>
          <span class="sub-title"><a href="https://www.dgl.ai">Home</a> / Blog Details</span>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- End Pages Banner Area -->

<!-- Start Blog Area -->
<section class="blog-area themeix-ptb">
  <div class="container">
    <div class="row">
      <!-- Start Blog Content -->
      <div class="col-md-12">
        <div class="blog-wrapper">

          <div class="single-blog-details">
            <div class="blog-img">
              <img src="https://i.imgur.com/OmLVXfo.png" alt="blog">
            </div>
            <div class="blog-content-desc">
              <h4 class="themeix-blog-h">Large-Scale Training of Graph Neural Networks</h4>
              <p><p>Many graph applications deal with <em>giant</em> scale. Social networks, recommendation and knowledge graphs have nodes and edges in the order of hundreds of millions or even billions of nodes. For example, a recent snapshot of the friendship network of Facebook contains 800 million nodes and over 100 billion links.</p>

<h2 id="sampling-methods-in-dgl">Sampling methods in DGL</h2>
<p>Giant graphs are a classic challenge, and is even more so in graph neural networks (GNN). In a GNN model, computing the embedding of a node depends on the embeddings of its neighbors. Such dependency leads to exponential growth of the number of nodes involved with number of GNN layers.</p>

<p>A typical technique is sampling, and there are many variants, some of them are applicable to GNN and DGL supports a few of them. The basic idea is to prune the node dependency to reduce the computation while still estimating the embeddings of GNN accurately. We leave the exact formulation of these techniques at the end of the tutorial (and users are encouraged to read them!), and describe the gists of them breifly here:</p>
<ul>
  <li><a href="https://arxiv.org/abs/1706.02216">neighbor sampling</a>. This is the most basic: simply pick a small number of random neighbors.</li>
  <li><a href="https://arxiv.org/abs/1809.05343">layer-wise sampling</a>. The problem with simple neighbor sampling is that number of nodes needed will continue to grow exponentially with deeper layers. The idea here is to consider a layer as a whole and constrain the amount of samples per layer.</li>
  <li><a href="https://arxiv.org/abs/1806.01973">random-walk sampling</a>. As the name suggests, samples are picked up by performing random walks.</li>
</ul>

<p>Sampling estimators can suffer from high variance. Obviously, including more neighbors will reduce the variance but this defeats the purpose of sampling. One interesting soution is <a href="https://arxiv.org/abs/1710.10568">control-variate sampling</a>, a standard variance reduction technique used in Monte Carlo methods.</p>

<p>The basic idea is simple: given a random variable <script type="math/tex">X</script> and we wish to estimate its expectation <script type="math/tex">\mathbb{E} [X] = \theta</script>, the control variate method finds another random variable <script type="math/tex">Y</script> which is highly correlated with <script type="math/tex">X</script> and whose expectation <script type="math/tex">\mathbb{E} [Y]</script> can be easily computed. Control variate needs to keep extra state, but otherwise is effective in reducing sample size. In fact, one neighbor is enough, for the Reddit dataset!
<!--
We experiment neighbor sampling and control variate sampling to train GCN and GraphSage on Reddit to evaluate the effectiveness of these two sampling methods. The result is shown in the figure below. For GCN, control variate sampling is much more effective than neighbor sampling. Sampling only one neighbor is sufficient to train GCN on the Reddit dataset. Similarly, when training GraphSage, we only need to sample one neighbor to get its accuracy over 96%.
-->
<img src="https://i.imgur.com/DTPQu5V.png" alt="" width="700x" class="aligncenter" /></p>

<h2 id="system-support-for-giant-graphs">System support for giant graphs</h2>
<p>Sampling provides the nice possiblity of dealing with giant graphs with a data-parallel perspective. DGL adds two components, see figure below:</p>

<ul>
  <li>
    <p><strong>Sampler</strong>: a sampler constructs small subgraphs (<code class="highlighter-rouge">NodeFlow</code>) from a given (giant) graph; tutorials of <code class="highlighter-rouge">NodeFlow</code> can be found <a href="https://doc.dgl.ai/tutorials/models/5_giant_graph/1_sampling_mx.html#sphx-glr-tutorials-models-5-giant-graph-1-sampling-mx-py">here</a>. Multiple samplers can be launched locally, or remotely, and on many machines.</p>
  </li>
  <li>
    <p><strong>Graph store</strong>: this prepares the I/O substrate to scale out with a large number of trainers. The graph store contains graph embeddings as well as its structure. For now, the implementation is based on shared-memory, supporting multi-processing training on multi-GPU and/or non-uniform memory access (NUMA) machines.</p>
  </li>
</ul>

<p>The shared-memory graph store has a similar interface to <code class="highlighter-rouge">DGLGraph</code> for programming. DGL will also support a distributed graph store that can store graph embeddings across machines in the future release.</p>

<!--
The figure below shows the interaction of the trainer with the samplers and the graph store. The trainer takes subgraphs (`NodeFlow`) from the sampler and fetches graph embeddings from the graph store before training. The trainer can push new graph embeddings to the graph store or invoke some computation on the graph store.
-->
<p><img src="https://i.imgur.com/OmLVXfo.png" alt="" width="700x" class="aligncenter" /></p>

<p>Now, let’s demonstrate how good these supports are.</p>

<h3 id="multi-processing-training-and-optimizations-on-a-numa-machine">Multi-processing training and optimizations on a NUMA machine</h3>
<p>The speedup is almost linear, and on Reddit dataset takes about only 20 seconds to converge to the accuracy of 96% with 20 iterations.</p>

<p><img src="https://i.imgur.com/eaiEcEi.png" alt="" class="aligncenter" /></p>

<ul>
  <li>X1.32xlarge instance has 4 processors, each of which has 16 physical CPU cores.</li>
  <li>We need to be aware of NUMA architecture, otherwise there’s hardly any speedup with more CPU processors. Please see <a href="https://doc.dgl.ai/tutorials/models/5_giant_graph/2_giant.html#sphx-glr-tutorials-models-5-giant-graph-2-giant-py">our tutorial</a> for more details.</li>
</ul>

<!--
To demonstrate the effectiveness of multi-processing training with this architecture on a NUMA machine and on a multi-GPU machine, we train GraphSage on the Reddit dataset with control-variate sampling. To optimize the training in a NUMA machine, we need to bind trainers' processes to specific NUMA nodes. Please see [our tutorial](https://doc.dgl.ai/tutorials/models/5_giant_graph/2_giant.html#sphx-glr-tutorials-models-5-giant-graph-2-giant-py) for more details how to bind processes on a NUMA node.
The figure below shows that NUMA-aware multi-processing training can accelerate training almost by a factor of 4 on an X1.32xlarge instance where there are 4 processors, each of which has 16 physical CPU cores. We can see that NUMA-unaware training cannot take advantage of computation power of the machine. It is even slightly slower than just using one of the processors in the machine. NUMA-aware training, on the other hand, takes about only 20 seconds to converge to the accuracy of 96% with 20 iterations.
-->

<h3 id="distributed-sampler">Distributed Sampler</h3>

<p>We can move samplers around. For GCN variants where computation aren’t that intense, running samplers on small (and cheaper) machines and training on NUMA is both faster and more cost-effective (additional 20%-40% speedups).</p>

<!--
are ran on different machines, we can 
We also notice that the sampling in many tasks takes a significant amount of time for the training process on a giant graph. So DGL supports distributed samplers for speeding up the sampling process on giant graphs. DGL allows users to launch multiple samplers on different machines concurrently, and each sampler can send its sampled subgraph (`NodeFlow`) to trainer machines continuously. 
The figure below shows the overall performance improvement of training GCN and GraphSage on the Reddit dataset after deploying NUMA optimizations and distributed sampling. Our NUMA optimization speeds up the training by a factor of 3. The distributed sampling achieves additional 20%-40% speed improvement for different tasks.
-->

<p><img src="https://i.imgur.com/e0MXa5N.png" alt="" width="700x" class="aligncenter" /></p>

<h3 id="scale-to-giant-graphs">Scale to giant graphs</h3>
<!--Finally, we would like to demonstrate the scalability of DGL on giant graphs. 
-->
<p>We create three large power-law graphs with <a href="http://www.cs.cmu.edu/~christos/PUBLICATIONS/siam04.pdf">RMAT</a>. Each node is associated with 100 features and we compute node embeddings with 64 dimensions. Below shows the training speed and memory consumption of GCN with neighbor sampling.</p>

<table>
  <thead>
    <tr>
      <th>#Nodes</th>
      <th>#Edges</th>
      <th>Time per epoch (s)</th>
      <th>Memory (GB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>5M</td>
      <td>250M</td>
      <td>4.7</td>
      <td>8</td>
    </tr>
    <tr>
      <td>50M</td>
      <td>2.5B</td>
      <td>46</td>
      <td>75</td>
    </tr>
    <tr>
      <td>500M</td>
      <td>25B</td>
      <td>505</td>
      <td>740</td>
    </tr>
  </tbody>
</table>

<p>We can see that DGL can scale to graphs with 500M nodes and 25B edges on an X1.32xlarge instance.</p>

<h2 id="whats-next">What’s next?</h2>
<p>We are looking forward to your feedbacks and would love to hear your use cases and models for giant graphs! All of these new features shown in this blog will be in our upcoming v0.3 release. Please try them out and give us feedbacks.</p>

<p>We are continuing working on our infrastructure for training graph neural networks on giant graphs, which includes:</p>
<ul>
  <li>In the infrastructure, we will add a distributed graph store to support fully distributed training for graph neural networks.</li>
  <li>We will experiment various strategies to accelerate distributed training. For example, we will experiment fast and scalable graph partitioning algorithms to reduce network communication.</li>
  <li>We will also add more demonstrations of other sampling strategies. For example, we will scale PinSage with our random walk sampler.</li>
</ul>

<h2 id="sampling-techniques-in-gnn">Sampling techniques in GNN</h2>

<p>Let’s use graph convolution network as an example to show these sampling techniques. Given a graph <script type="math/tex">G=(V, E)</script>, represented as an adjacency matrix <script type="math/tex">A</script>, with node features <script type="math/tex">H^{(0)} = X \in \mathbb{R}^{|V| \times m}</script>, graph convolution networks (GCNs) compute the hidden features <script type="math/tex">H^{(l+1)}</script> of the <script type="math/tex">(l+1)</script>-th layer by computing for each <script type="math/tex">v</script>
<script type="math/tex">h_v^{(l+1)} = \sigma ( z_v^{(l)} W^{(l)}) \qquad z_v^{(l)} = \sum_{u \in \mathcal{N}(v)} \tilde{A}_{uv} h_u^{(l)}</script>
where <script type="math/tex">\mathcal{N}(v)</script> denotes the neighborhood of <script type="math/tex">v</script>, <script type="math/tex">\tilde{A}</script> is a normalized version of <script type="math/tex">A</script> such as <script type="math/tex">D^{-1} A</script>, <script type="math/tex">\sigma(\cdot)</script> is the activation function, <script type="math/tex">W^{(l)}</script> is a trainable parameter of the <script type="math/tex">l</script>-th layer. For a <script type="math/tex">L</script>-layer GCN model, the computation of <script type="math/tex">H^{(L)}</script> requires the propagation from all of its <script type="math/tex">L</script>-hop neighbors. This is too expensive in mini-batch training because the receptive field of a node grows exponentially with respective to the number of layers <script type="math/tex">L</script>.</p>

<p><strong>Neighbor Sampling</strong>
Instead of using all the <script type="math/tex">L</script>-hop neighbors of a node <script type="math/tex">v</script>, neighbor sampling randomly samples a few neighbors <script type="math/tex">\hat{\mathcal{N}}^{(l)}(v)</script> to estimate the aggregation <script type="math/tex">z_v^{(l)}</script> of its total neighbors <script type="math/tex">\mathcal{N}(v)</script> in <script type="math/tex">l</script>-th GCN layer by an unbiased estimator <script type="math/tex">\hat{z}_v^{(l)}</script></p>

<script type="math/tex; mode=display">\hat{z}_v^{(l)} = \frac{\vert \mathcal{N}(v) \vert }{\vert \hat{\mathcal{N}}^{(l)}(v) \vert} \sum_{u \in \hat{\mathcal{N}}^{(l)}(v)} \tilde{A}_{uv} \hat{h}_u^{(l)} \\
\hat{h}_v^{(l+1)} = \sigma ( \hat{z}_v^{(l)} W^{(l)} )</script>

<p>Let <script type="math/tex">D^{(l)}</script> be the number of neighbors to be sampled for each node at the <script type="math/tex">l</script>-th layer, then the receptive field size of each node can be controlled under <script type="math/tex">\prod_{i=0}^{L-1} D^{(l)}</script> by neighbor sampling.</p>

<p><strong>Layer-Wise Sampling</strong>
In node-wise sampling, each parent node <script type="math/tex">v</script> independently samples a few neighbors <script type="math/tex">\hat{\mathcal{N}}(v)</script>, which are not visible to other parent nodes <script type="math/tex">u</script> except <script type="math/tex">v</script>. The receptive field size still grows exponentially if <script type="math/tex">\vert \hat{\mathcal{N}}(v) \vert > 1</script>. In layer-wise sampling, the sampling procedure is performed only once in each layer, where each node <script type="math/tex">v</script> gets sampled into <script type="math/tex">\mathcal{S}^{(l)}</script> with probability <script type="math/tex">p^{(l)}(v)</script>,
<script type="math/tex">\hat{z}_v^{(l)} = \sum_{u \in \mathcal{S}^{(l)}} \frac{1}{p^{(l)}(u)} \tilde{A}_{uv} \hat{h}_u^{(l)}</script>
The receptive field size can be controlled directly by <script type="math/tex">\vert \mathcal{S}^{(0)} \vert</script>.</p>

<p><strong>Random Walk Sampling</strong>
Given a source node <script type="math/tex">s</script> and a decay factor <script type="math/tex">\alpha</script>, a random walk from <script type="math/tex">s</script> is a trace beginning from <script type="math/tex">s</script>, at each step either proceeds to a neighbor uniformly at random, or stop with probability <script type="math/tex">\alpha</script>. The personalized PageRank (PPR) score <script type="math/tex">\pi(s, t)</script> is the probability that a random walk from <script type="math/tex">s</script> terminates at <script type="math/tex">t</script>.</p>

<p>In PinSage, each node <script type="math/tex">v</script> selects top-<script type="math/tex">k</script> important nodes with highest PPR scores with respective to <script type="math/tex">v</script> as its neighbors <script type="math/tex">\hat{\mathcal{N}}(v)</script>, and the hidden feature of each neighbor <script type="math/tex">u \in \hat{\mathcal{N}}(v)</script> is weighted by <script type="math/tex">\pi(v, u)</script>,</p>

<script type="math/tex; mode=display">\hat{z}^{(l)}_v = \frac{\sum_{u \in \hat{\mathcal{N}}(v)} \pi(v, u) \tilde{A}_{uv} \hat{h}_u^{(l)}}{\sum_{u \in \hat{\mathcal{N}}(v)} \pi(v, u)}</script>

<p>Compared to GCNs which uses all the <script type="math/tex">L</script>-hop neighbors, PinSage selects <script type="math/tex">k</script> topology-based important neighbors which have the largest influence.</p>

<p><strong>Control Variate</strong>
Although unbiased, sampling estimators such as <script type="math/tex">\hat{z}_v^{(l)}</script> in neighbor sampling suffers from high variance, so it still requires a relatively large number of neighbors, e.g. <script type="math/tex">D^{(0)}=25</script> and <script type="math/tex">D^{(1)}=10</script> in the GraphSage paper. With control variate, a standard variance reduction technique used in Monte Carlo methods, 2 neighbors for a node are sufficient in the experiments.</p>

<p>Given a random variable <script type="math/tex">X</script> and we wish to estimate its expectation <script type="math/tex">\mathbb{E} [X] = \theta</script>, the control variate method finds another random variable <script type="math/tex">Y</script> which is highly correlated with <script type="math/tex">X</script> and whose expectation <script type="math/tex">\mathbb{E} [Y]</script> can be easily computed. The control variate estimator is</p>

<script type="math/tex; mode=display">Z = X - Y + \mathbb{E} [Y]</script>

<p><script type="math/tex">\mathbb{VAR} [Z] = \mathbb{VAR} [X] + \mathbb{VAR} [Y] - 2 \cdot \mathbb{COV} [X, Y]</script>
If <script type="math/tex">% <![CDATA[
\mathbb{VAR} [Y] - 2\mathbb{COV} [X, Y] < 0 %]]></script>, then <script type="math/tex">% <![CDATA[
\mathbb{VAR} [Z] < \mathbb{VAR} [X] %]]></script>.</p>

<p>For GCN, by using history <script type="math/tex">\bar{H}^{(l)}</script> of the nodes which are not sampled, the modified estimator <script type="math/tex">\hat{z}_v^{(l)}</script> is</p>

<script type="math/tex; mode=display">\hat{z}_v^{(l)} = \frac{\vert \mathcal{N}(v) \vert }{\vert \hat{\mathcal{N}}^{(l)}(v) \vert} \sum_{u \in \hat{\mathcal{N}}^{(l)}(v)} \tilde{A}_{uv} ( \hat{h}_u^{(l)} - \bar{h}_u^{(l)} ) + \sum_{u \in \mathcal{N}(v)} \tilde{A}_{uv} \bar{h}_u^{(l)}</script>
</p>
              <div class="blog-post-date">
                <p>13 <span>June</span> </p>
              </div>
              <div class="tag-links mt-30">
                <div class="widget">
                  <div class="tagcloud">
                    <a href="/tag/blog.html" class="set-4">blog</a> <a href="/tag/news.html" class="set-2">news</a> <a href="/tag/release.html" class="set-5">release</a>
                  </div>
                </div>
                <div class="blog-data">
                  <p>By 
                  
                  <a href="http://www.cs.jhu.edu/~zhengda/">Da Zheng</a>,
                  
                  <a href="https://github.com/aksnzhy">Chao Ma</a>,
                  
                  <a href="https://github.com/ZiyueHuang">Ziyue Huang</a>,
                  
                  <a href="https://barclayii.github.io/">Quan Gan</a>,
                  
                  <a href="https://github.com/GaiYu0">Yu Gai</a>,
                  
                  <a href="https://shanghai.nyu.edu/academics/faculty/directory/zheng-zhang">Zheng Zhang</a>,
                   in <a href="#">blog</a> </p>
                </div>
              </div>
              <!-- Leave a Comment -->
              <div id="respond">
                <div class="comment-respond pb-50">
                  <div id='discourse-comments'></div>
                  <script type="text/javascript">
  DiscourseEmbed = { discourseUrl: 'https://discuss.dgl.ai/',
                     discourseEmbedUrl: 'https://www.dgl.ai/blog/2019/06/13/giant.html' };

  (function() {
    var d = document.createElement('script'); d.type = 'text/javascript'; d.async = true;
    d.src = DiscourseEmbed.discourseUrl + 'javascripts/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(d);
  })();
</script>

                </div>
              </div>
              <!-- End Leave a Comment -->
            </div>
          </div>
        </div>
      </div>
      <!-- End Blog Content -->
      <!-- Start Blog Sidebar -->
      <!--
      <div class="col-md-3">
        <div class="row">
          <div class="blog-sidebar">
            <div class="col-md-12 col-sm-6">
              <aside id="dwqa-categories-2" class="widget widget_categories dwqa_widget dwqa_widget_categories sidebar-list">
                <h4 class="list-title">Categories</h4>
<ul>
	
	
    
	 <li><a href="topics/AngularJS">AngularJS</a></li> 
	

</ul>



              </aside>
            </div>
            <div class="col-md-12 col-sm-6">
              <aside class="widget dwqa-widget dwqa-popular-question">
                <div class="sidebar-popular-post dwqa-popular-questions">
                  <div class="popular-questions"> 
<h2 class="widget-title">Popular Questions</h2>
<ul>

    

    
     <li><a href="/category_one/question_two">Can I Start Learning AngularJS Framework ?</a></li>
    
     <li><a href="/category_one/question_one">What is AngularJS ?</a></li>
    

    
    
     <li><a href="/category_two/question_three">How Can I Learning ReactJS Framework ?</a></li>
    
     <li><a href="/category_two/question_two">How Can I Learning ReactJS Framework ?</a></li>
    

    
    
     <li><a href="/category_three/question_three">Can I Learning EmberJS Framework ?</a></li>
    
     <li><a href="/category_three/question_two">How Can I Learning EmberJS Framework ?</a></li>
    

    
    
     <li><a href="/category_four/question_one">What is VueJS ?</a></li>
    
     <li><a href="/category_four/question_two">How Can I Learning VueJS Framework ?</a></li>
    

 </ul>
</div>
                </div>
              </aside>
            </div>
          </div>
        </div>
      </div>
      -->
      <!-- End Blog Sidebar -->
    </div>
  </div>
</section>
<!-- End Blog Area -->


    <!-- Start Footer Area -->
    <footer>
        <div class="footer-area themeix-ptb">
            <div class="container">
                <div class="row">
                    <div class="footer-wrapper">
                        <div class="col-sm-6 col-md-3">
                            <div class="single-footer">
                                <h3 class="footer-heading">Follow Us</h3>
                                <div class="single-footer-text">
                                    <p>Keep track the latest news, blogs and updates of DGL by following our social media accounts.</p>
                                </div>
                                <div class="social-links">
                                    <ul>
                                        <li><a href="https://twitter.com/GraphDeep"><i class="fa fa-twitter"></i></a></li>
                                        <li class="fb-link"><a href="https://www.facebook.com/GraphDeep/"><i class="fa fa-facebook"></i></a></li>
                                        <li><a href="/feed.xml"><i class="fa fa-rss"></i></a></li>
                                        <!--<li class="gp-link"><a href="#"><i class="fa fa-google-plus"></i></a></li>-->
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="single-footer">
                                <h3 class="footer-heading">Quick Links</h3>
                                <div class="footer-list">
                                    <ul>
                                        <li><a href="/pages/about.html">About us</a></li>
                                        <li><a href="/pages/start.html">Get started</a></li>
                                        <li><a href="https://github.com/dmlc/dgl/releases">Latest updates</a></li>
                                        <li><a href="/pages/index.html">Blogs</a></li>
                                        <li><a href="https://github.com/dmlc/dgl/">Github</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="single-footer">
                                <h3 class="footer-heading">Materials</h3>
                                <div class="footer-list">
                                    <ul>
                                        <li><a href="https://docs.dgl.ai/tutorials/models/index.html">Tutorials</a></li>
                                        <li><a href="https://discuss.dgl.ai">Discuss forum</a></li>
                                        <li><a href="https://github.com/dmlc/dgl/issues">Github issues</a></li>
                                        <li><a href="https://github.com/dmlc/dgl/blob/master/CONTRIBUTORS.md">Contributing</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!--
                        <div class="col-sm-6 col-md-3">
                            <div class="single-footer">
                                <h3 class="footer-heading">get support</h3>
                                <p>Don’t miss our latest realeses and important updates</p>
                                <div class="subscribe-form">
                                    <form action="https://formspree.io/your@email.com" method="post">
                                        <input type="email" name="subscribe" id="subscribe" class="form-control" placeholder="Email" required>
                                        <button type="submit" class="hover-bg">Go</button>
                                    </form>
                                    <span>We never do spam with you</span>
                                </div>
                            </div>
                        </div>
                        -->
                    </div>
                </div>
            </div>
        </div>
        <!-- Start Footer Bottom Area -->
        <!--
        <div class="footer-bottom-area themeix-pb">
            <div class="container">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="footer-bottom">
                            <div class="footer-logo">
                                <a href="#"><img src="/assets/images/footer-logo.png" alt="logo"></a>
                            </div>
                            <div class="footer-links">
                                <ul>
                                    <li><a href="#">Privacy Policy</a></li>
                                    <li><a href="#">Refund Policy</a></li>
                                    <li><a href="#">Disclaimer</a></li>
                                </ul>
                            </div>
                            <div class="copyright-text">
                                <p>All content Documenter &copy; 2017 - All rights reserved. - Proudly made with <a href="http://designingmarket.com">Designing Market</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        -->
        <!-- End Footer Bottom Area -->
        <!-- Start Scroll To Top -->
        <div class="scroll-top">
            <div class="scroll-icon">
                <i class="fa fa-angle-up"></i>
            </div>
        </div>
        <!-- End Scroll To Top -->
    </footer>
    <!-- End Footer Area -->

    <!-- jquery min -->
    <script src="/assets/js/jquery.min.js"></script>

    <!-- Bootstrap Js -->
    <script src="/assets/js/bootstrap.min.js"></script>

    <!-- jQuery Easing -->
    <script src="/assets/js/jquery.easing.js"></script>

    <!-- Owl Carousel Js -->
    <script src="/assets/js/owl.carousel.min.js"></script>

    <!-- Google Map -->
    <!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAOCx7VEftKaGSK2F2p_tUKmMSdN00palo"></script> -->

    <!-- Mean Menu -->
    <script src="/assets/js/jquery.meanmenu.js"></script>

    <!-- Particles JS CDN -->
    <script src="/assets/js/particles.min.js"></script> 

    <!-- Main Js -->
    <script src="/assets/js/main.js"></script>

    <!-- MathJax Js -->
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
</body>

</html>
