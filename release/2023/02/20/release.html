<head>
    <!-- meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Library for deep learning on graphs">
    <meta name="keywords" content="Software, Machine Learning, Deep Learning, Neural Network, Graph">
    <meta name="author" content="Themeix">

    <!-- Site Title -->
    <title>Deep Graph Library</title>

    <!-- favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/assets/images/dgl-favicon.png">

    <!-- IView CSS -->
    <link rel="stylesheet" href="//unpkg.com/iview/dist/styles/iview.css">

    <!-- Bootstrap CSS -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font-Awesome CSS -->
    <link href="/assets/css/font-awesome.min.css" rel="stylesheet">

    <!-- Google Fonts -->
    <link href="/assets/css/googlefont.css" rel="stylesheet"> 

    <!-- Animate CSS -->
    <link rel="stylesheet" href="/assets/css/animate.min.css">

    <!-- Owl Carousel CSS -->
    <link rel="stylesheet" href="/assets/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/assets/css/owl.theme.default.min.css">
    <!--<link rel="stylesheet" href="/assets/css/owl.carousel.min.css">-->

    <!-- Mean Menu CSS -->
    <link rel="stylesheet" href="/assets/css/meanmenu.min.css">

    <!-- Main Stylesheet -->
    <link href="/assets/css/style.css" rel="stylesheet">

    <!-- Responsive CSS -->
    <link href="/assets/css/responsive.css" rel="stylesheet">

    <!-- Minima CSS -->
    <link href="/assets/main.css" rel="stylesheet">

    <!-- Rouge Highlighter CSS -->
    <link href="/assets/css/syntax.css" rel="stylesheet">

    <link type="application/atom+xml" rel="alternate" href="https://www.dgl.ai/feed.xml" title="Deep Graph Library" />

    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="//oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-132455605-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-132455605-1');
</script>

    
</head>
  
<body>
    <!-- Preloader starts-->
    <div class="preloader">
        <div class="loading-center">
            <div class="loading-center-absolute">
                <div class="object object_one"></div>
                <div class="object object_two"></div>
                <div class="object object_three"></div>
            </div>
        </div>
    </div>
    <!-- Preloader ends -->
    <!-- Start Header -->
    <header>
      <!-- Start Mainmenu -->
<div class="menu-area navbar-fixed-top ">
    <div class="container">
        <div class="row">
            <div class="mainmenu-wrapper">
                <!-- Start Header Logo -->
                <div class="col-xs-12 col-md-3">
                    <div class="header-logo">
                        <a href="https://www.dgl.ai"><img src="/assets/images/logo.png" alt="logo"></a>
                    </div>
                </div>
                <!-- End Header Logo -->
                <!-- Start Navigation -->
                <div class="col-xs-12 col-md-9">
                    <div class="mainmenu">
                        <div class="navbar navbar-right">
                            <div class="navbar-header visible-xs">
                                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                                    <span class="sr-only">Toggle navigation</span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                </button>
                            </div>
                            <div class="collapse navbar-collapse top-menu">

                           <!--  Static Dropdown Menu 

                                <nav>
                                    <ul class="nav navbar-nav">
                                        <li class="active"><a href="https://www.dgl.ai">Home<span>Get everything</span></a>
                                           <ul class="dropdown">
                                               <li><a href="index.html">Home Version 1</a></li>
                                               <li><a href="index-2.html">Home Version 2</a></li>
                                           </ul>                                                
                                        </li>
                                        <li><a href="about-us.html">About<span>Know about us</span></a></li>                                
                                        <li><a href="questions.html">Questions<span>Ask Your Question</span></a>
                                            <ul class="dropdown">
                                                <li>
                                                    <a href="questions.html"> <span><i class="fa fa-question-circle"></i></span>All Questions</a>
                                                </li>                                                       
                                                <li><a href="ask-question.html"><span><i class="fa  fa-question-circle-o"></i></span>Ask Questions</a></li>
                                                <li><a href="answers.html"><span><i class="fa fa-reply-all"></i></span>Answers</a></li>
                                                <li><a href="login.html"><span><i class="fa fa-sign-in"></i></span>Login</a></li>
                                                <li><a href="register.html"><span><i class="fa fa-registered"></i></span>Register</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#">Pages<span>See All Pages</span></a>
                                           <ul class="dropdown">
                                               <li><a href="index-2.html">Home 2</a></li>
                                               <li><a href="blog.html">Blog</a></li>
                                               <li><a href="blog-details.html">Blog Details</a></li>
                                               <li><a href="questions.html">Questions</a></li>
                                               <li><a href="answers.html">Answers</a></li>
                                               <li><a href="updates.html">Updates</a></li>
                                               <li><a href="contact.html">Contact</a></li>
                                               <li><a href="left-sidebar.html">Left Sidebar</a></li>
                                               <li><a href="right-sidebar.html">Right Sidebar</a></li>
                                               <li><a href="login.html">login</a></li>
                                               <li><a href="register.html">Register</a></li>
                                               <li><a href="404.html">404</a></li>
                                           </ul>
                                        </li>
                                        <li><a href="blog.html">Blog<span>All Blog Posts</span></a></li>
                                        <li><a href="updates.html">Updates<span>Latest releases</span></a></li>
                                        <li><a href="contact.html">Contact<span>Let us contact</span></a></li>
                                    </ul>
                                </nav> 

                                End Static Dropdown Menu -->

                                <nav>
                                    <ul class="nav navbar-nav">
                                    
                                    
                                    
                                    
                                     <li>
                                        <a href="/pages/about.html">about
                                          <!--<span>About DGL</span>-->
                                        </a>
                                     </li>
                                    
                                    
                                    
                                    
                                    
                                     <li>
                                        <a href="/pages/start.html">Get Started
                                          <!--<span>Install</span>-->
                                        </a>
                                     </li>
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                     <li>
                                        <a href="https://docs.dgl.ai/tutorials/blitz/index.html">Tutorials
                                        </a>
                                     </li>
                                     <li>
                                        <a href="/pages/index.html">Blogs
                                        </a>
                                     </li>
                                     <li>
                                        <a href="https://docs.dgl.ai">Docs
                                        </a>
                                     </li>
                                     <li>
                                        <a href="https://discuss.dgl.ai">Forum
                                        </a>
                                     </li>
                                     <li>
                                        <a href="https://github.com/dmlc/dgl">GitHub
                                        </a>
                                     </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Navigation -->
            </div>
        </div>
    </div>
</div>
<!-- End Mainmenu -->
<!-- Start Mobile Menu Area -->
<div class="col-xs-12 visible-xs">
    <div class="mobile-menu">
        <nav>
            <ul>
                <li><a href="/index.html">Home</a></li>
                
                
                
                
                 <li>
                    <a href="/pages/about.html">about
                    </a>
                 </li>
                
                
                
                
                
                 <li>
                    <a href="/pages/start.html">Get Started
                    </a>
                 </li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <!--
                <li><a href="#">Questions</a>
                    <ul>
                        <li><a href="questions.html"> Questions</a></li>
                        <li><a href="ask-question.html">Ask Questions</a></li>
                        <li><a href="answers.html">Answers</a></li>
                        <li><a href="login.html">Login</a></li>
                        <li><a href="register.html">Register</a></li>                               
                    </ul>
                </li>
                <li><a href="#">Pages</a>
                    <ul>
                       <li><a href="blog.html">Blog</a></li>
                       <li><a href="blog-details.html">Blog Details</a></li>
                       <li><a href="questions.html">Questions</a></li>
                       <li><a href="answers.html">Answers</a></li>
                       <li><a href="updates.html">Updates</a></li>
                       <li><a href="contact.html">Contact</a></li>
                       <li><a href="left-sidebar.html">Left Sidebar</a></li>
                       <li><a href="right-sidebar.html">Right Sidebar</a></li>
                       <li><a href="login.html">login</a></li>
                       <li><a href="register.html">Register</a></li>
                       <li><a href="404.html">404</a></li>                          
                    </ul>
                </li>                       
                -->
                <li><a href="https://docs.dgl.ai/tutorials/blitz/index.html">Tutorials</a></li>
                <li><a href="/pages/index.html">Blogs</a></li>
                <li><a href="https://docs.dgl.ai">Docs</a></li>
                <li><a href="https://discuss.dgl.ai">Forum</a></li>
                <li><a href="https://github.com/dmlc/dgl">GitHub</a></li>
            </ul>
        </nav>
    </div>
</div>
<!-- End MObile Menu Area

   </header>
    <!-- End Header -->
<!-- Start Page Banner Area -->
<div class="page-banner-area">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="page-title">
          <h2>Blog Details</h2>
          <span class="sub-title"><a href="https://www.dgl.ai">Home</a> / Blog Details</span>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- End Pages Banner Area -->

<!-- Start Blog Area -->
<section class="blog-area themeix-ptb">
  <div class="container">
    <div class="row">
      <!-- Start Blog Content -->
      <div class="col-md-12">
        <div class="blog-wrapper">

          <div class="single-blog-details">
            <div class="blog-img">
              <img src="/assets/images/posts/2023-02-20-release/blog_banner.png" alt="blog">
            </div>
            <div class="blog-content-desc">
              <h4 class="themeix-blog-h">DGL 1.0: Empowering Graph Machine Learning for Everyone</h4>
              <p><p>We are thrilled to announce the arrival of DGL 1.0, a cutting-edge machine
learning framework for deep learning on graphs. Over the past three years,
there has been growing interest from both academia and industry in this
technology. Our framework has received requests from various scenarios, from
academic research on state-of-the-art models to industrial demands for scaling
Graph Neural Network (GNN) solutions to large, real-world problems. With DGL
1.0, we aim to provide a comprehensive and user-friendly solution for all users
to take advantage of graph machine learning.</p>

<p><img src="/assets/images/posts/2023-02-20-release/request.png" alt="request" width="800x" class="aligncenter" /></p>
<p><center>Different levels of user requests and what DGL 1.0 provides to fulfill them</center></p>

<p>DGL 1.0 adopts a layered and modular design to fulfill various user requests. The key features of DGL 1.0 include:</p>

<ul>
  <li><a href="https://github.com/dmlc/dgl/tree/master/examples/pytorch">100+ examples</a> of
state-of-the-art GNN models, <a href="https://github.com/dmlc/dgl/tree/master/examples/pytorch/ogb">15+ top-ranked baselines</a> on
Open Graph Benchmark (OGB), available for learning and integration</li>
  <li><a href="https://docs.dgl.ai/api/python/nn-pytorch.html">150+ GNN utilities</a>
including GNN layers, datasets, graph data transform modules, graph samplers,
etc. for building new model architectures or GNN-based solutions</li>
  <li>Flexible and efficient message passing and sparse matrix abstraction for
developing new GNN building blocks</li>
  <li>Multi-GPU and distributed training capability to scale to graphs of billions
of nodes and edges</li>
</ul>

<p>The new additions and updates in DGL 1.0 are depicted in the accompanying
figure. One of the highlights of this release is the introduction of
<strong>DGL-Sparse</strong>, a new specialized package for graph ML models defined in sparse
matrix notations. DGL-Sparse streamlines the programming process not just for
well-established GNNs such as Graph Convolutional Networks, but also for the
latest models, including diffusion-based GNNs, hypergraph neural networks, and
Graph Transformers. In the following article, we will provide an overview of
two popular paradigms for expressing GNNs, i.e., the message passing view and
the matrix view, which motivated the creation of DGL-Sparse. We will then show
you how to get started with this new and exciting feature.</p>

<p><img src="/assets/images/posts/2023-02-20-release/arch.png" alt="arch" width="800x" class="aligncenter" /></p>
<p><center>DGL 1.0 stack</center></p>

<h2 id="the-message-passing-view-vs-the-matrix-view">The Message Passing View v.s. The Matrix View</h2>

<p><em>“It’s the theory that the language you speak determines how you think and affects how you see everything.” — Louise Banks from Film Arrival</em></p>

<p>Representing a Graph Neural Network can take two distinct forms. The first,
known as the message passing view, approaches GNN models from a <em>fine-grained,
local</em> perspective, detailing how messages are exchanged along edges and how
node states are updated accordingly. Alternatively, due to the algebraic
equivalence of a graph to a sparse adjacency matrix, many researchers opt to
express their GNN models from a coarse-grained, global perspective, emphasizing
the operations involving the sparse adjacency matrix and dense feature tensors.</p>

<p><img src="/assets/images/posts/2023-02-20-release/view.png" alt="view" width="800x" class="aligncenter" /></p>

<p>These local and global perspectives are sometimes interchangeable, but more
often, provide complementary insights into the fundamentals and limitations of
GNNs. For instance, the message passing view highlights the connection between
GNNs and the Weisfeiler Lehman (WL) graph isomorphism test, which also relies
on aggregating information from neighbors (as described in <a href="https://arxiv.org/abs/1810.00826">Xu et al., 2018</a>).
Meanwhile, the matrix view provides valuable understanding of the algebraic
properties of GNNs, leading to intriguing findings such as the <em>oversmoothing</em>
phenomenon (as discussed in <a href="https://arxiv.org/abs/1801.07606">Li et al., 2018</a>). In conclusion, both the message
passing view and matrix view are indispensable tools in studying and describing
GNNs, and this is precisely what motivates the key feature we will be
showcasing in DGL 1.0.</p>

<h2 id="dgl-sparse-sparse-matrix-abstraction-for-graph-ml">DGL Sparse: Sparse Matrix Abstraction for Graph ML</h2>

<p>In DGL 1.0, we are happy to announce the release of DGL Sparse, a new
sub-package (<code class="highlighter-rouge">dgl.sparse</code>) in addition to the existing message passing interface
in DGL to accomplish the support of the entire spectrum of GNN models. DGL
Sparse provides sparse matrix classes and operations specialized for Graph ML,
making it easier to program GNNs described in the matrix view. In the following
section, we will demonstrate a few examples of GNNs, showcasing their
mathematical formulation and corresponding code implementation in DGL Sparse.</p>

<p>The <strong>Graph Convolutional Network</strong> (<a href="https://arxiv.org/abs/1609.02907">Kipf et al., 2017</a>) is one of the pioneer works
in GNN modeling. GCN can be expressed in both message passing view and matrix
view. The code below compares the two different perspectives and
implementations in DGL.</p>

<p><img src="/assets/images/posts/2023-02-20-release/gcn.png" alt="gcn" width="800x" class="aligncenter" /></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">dgl.function</span> <span class="kn">as</span> <span class="nn">fn</span>  <span class="c"># DGL message passing functions</span>

<span class="k">class</span> <span class="nc">GCNLayer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="o">...</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s">'X'</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span>
        <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s">'deg'</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">in_degrees</span><span class="p">()</span><span class="o">.</span><span class="nb">float</span><span class="p">()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">update_all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">,</span> <span class="n">fn</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="s">'m'</span><span class="p">,</span> <span class="s">'X_neigh'</span><span class="p">))</span>
        <span class="n">X_neigh</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s">'X_neigh'</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="p">(</span><span class="n">X_neigh</span><span class="p">))</span>
    
    <span class="k">def</span> <span class="nf">message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
        <span class="n">c_ij</span> <span class="o">=</span> <span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">src</span><span class="p">[</span><span class="s">'deg'</span><span class="p">]</span> <span class="o">*</span> <span class="n">edges</span><span class="o">.</span><span class="n">dst</span><span class="p">[</span><span class="s">'deg'</span><span class="p">])</span> <span class="o">**</span> <span class="o">-</span><span class="mf">0.5</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">'m'</span> <span class="p">:</span> <span class="n">edges</span><span class="o">.</span><span class="n">src</span><span class="p">[</span><span class="s">'X'</span><span class="p">]</span> <span class="o">*</span> <span class="n">c_ij</span><span class="p">}</span>
</code></pre>
</div>
<p><center>GCN in DGL's message passing API</center></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">dgl.sparse</span> <span class="kn">as</span> <span class="nn">dglsp</span>  <span class="c"># DGL 1.0 sparse matrix package</span>

<span class="k">class</span> <span class="nc">GCNLayer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="o">...</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">D_invsqrt</span> <span class="o">=</span> <span class="n">dglsp</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="o">-</span><span class="mf">0.5</span>
        <span class="n">A_norm</span> <span class="o">=</span> <span class="n">D_invsqrt</span> <span class="err">@</span> <span class="n">A</span> <span class="err">@</span> <span class="n">D_invsqrt</span>
        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="p">(</span><span class="n">A_norm</span> <span class="err">@</span> <span class="n">X</span><span class="p">))</span>
</code></pre>
</div>
<p><center>GCN in DGL Sparse</center></p>

<p><strong>Graph Diffusion-based GNNs.</strong> Graph diffusion is a process of propagating or
smoothing node features/signals along edges. Many classical graph algorithms
such as PageRank belong to this category. A series of research has shown that
combining graph diffusion with neural networks is an effective and efficient
way to enhance model predictions. The equation below describe the core
computation of one representative model — <em>Approximated Personalized Propagation
of Neural Prediction</em> (<a href="https://arxiv.org/abs/1810.05997">Gasteiger et al., 2018</a>), which can be implemented in DGL
Sparse straightforwardly.</p>

<p><img src="/assets/images/posts/2023-02-20-release/appnp.png" alt="appnp" width="300x" class="aligncenter" /></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">APPNP</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="o">...</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">Z_0</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_theta</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_hops</span><span class="p">):</span>
            <span class="n">A_drop</span> <span class="o">=</span> <span class="n">dglsp</span><span class="o">.</span><span class="n">val_like</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A_dropout</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">val</span><span class="p">))</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">A_drop</span> <span class="err">@</span> <span class="n">Z</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">Z_0</span>
        <span class="k">return</span> <span class="n">Z</span>
</code></pre>
</div>

<p><strong>Hypergraph Neural Networks</strong>. A hypergraph is a generalization of a graph in
which an edge can join any number of nodes (called an hyperedge). Hypergraphs
are particularly useful in scenarios that require capturing high-order
relations such as co-purchase behaviors in e-commerce platforms, or
co-authorship in citation networks, etc. A hypergraph is typically
characterized by its sparse incidence matrix, and thus Hypergraph Neural
Networks (HGNN) are commonly defined in sparse matrix notations. The equation
and code implementation of Hypergraph Convolution, proposed by <a href="https://arxiv.org/abs/1809.09401">Feng et al.,
2018</a>, are presented below.</p>

<p><img src="/assets/images/posts/2023-02-20-release/hypergraph.png" alt="hypergraph" width="800x" class="aligncenter" /></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">HypergraphConv</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="o">...</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">d_V</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c"># node degree</span>
        <span class="n">d_E</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c"># edge degree</span>
        <span class="n">n_edges</span> <span class="o">=</span> <span class="n">d_E</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">D_V_invsqrt</span> <span class="o">=</span> <span class="n">dglsp</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">d_V</span><span class="o">**-</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c"># D_V ** (-1/2)</span>
        <span class="n">D_E_inv</span> <span class="o">=</span> <span class="n">dglsp</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">d_E</span><span class="o">**-</span><span class="mi">1</span><span class="p">)</span>  <span class="c"># D_E ** (-1)</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">dglsp</span><span class="o">.</span><span class="n">identity</span><span class="p">((</span><span class="n">n_edges</span><span class="p">,</span> <span class="n">n_edges</span><span class="p">))</span>
        <span class="n">L</span> <span class="o">=</span> <span class="n">D_V_invsqrt</span> <span class="err">@</span> <span class="n">H</span> <span class="err">@</span> <span class="n">W</span> <span class="err">@</span> <span class="n">D_E_inv</span> <span class="err">@</span> <span class="n">H</span><span class="o">.</span><span class="n">T</span> <span class="err">@</span> <span class="n">D_V_invsqrt</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Theta</span><span class="p">(</span><span class="n">L</span> <span class="err">@</span> <span class="n">X</span><span class="p">)</span>
</code></pre>
</div>

<p><strong>Graph Transformers</strong>. The Transformer has proven to be an effective learning
architecture in natural language processing and computer vision. Researchers
have begun to extend the use of Transformers to graph learning as well. One of
the pioneer work by (<a href="https://arxiv.org/abs/2012.09699">Dwivedi et al., 2020</a>) proposed to constrain the all-pair
multi-head attention to the connected node pairs in a graph. With DGL Sparse,
implementing this new formulation is now a straightforward process, taking only
about 10 lines of code.</p>

<p><img src="/assets/images/posts/2023-02-20-release/gt.png" alt="gt" width="800x" class="aligncenter" /></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">GraphMHA</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="o">...</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_proj</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_dim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_heads</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaling</span>
        <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_proj</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_dim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_heads</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_proj</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_dim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_heads</span><span class="p">)</span>

        <span class="n">attn</span> <span class="o">=</span> <span class="n">dglsp</span><span class="o">.</span><span class="n">bsddmm</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">k</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c"># [N, N, nh]</span>
        <span class="n">attn</span> <span class="o">=</span> <span class="n">attn</span><span class="o">.</span><span class="n">softmax</span><span class="p">()</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">dglsp</span><span class="o">.</span><span class="n">bspmm</span><span class="p">(</span><span class="n">attn</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_proj</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</code></pre>
</div>

<h3 id="key-features-of-dgl-sparse">Key Features of DGL Sparse</h3>

<p>To handle diverse use cases in an efficient manner, DGL Sparse is designed with
two key features that set it apart from other sparse matrix libraries such as
<code class="highlighter-rouge">scipy.sparse</code> or <code class="highlighter-rouge">torch.sparse</code>:</p>

<ul>
  <li><strong>Automatic Sparse Format Selection</strong>. DGL Sparse eliminates the complexity of
choosing the right data structure for storing a sparse matrix (also known as
the <em>sparse format</em>). Users can create a sparse matrix with a single call to
<code class="highlighter-rouge">dgl.sparse.spmatrix</code> and the internal DGL’s sparse matrix will automatically
select the optimal format based on the intended operation.</li>
  <li><strong>Scalar or Vector Non-zero Elements</strong>. GNN models often associate edges with
multi-channel weight vectors, such as multi-head attention vectors, as
demonstrated in the Graph Transformer example. To accommodate this, DGL Sparse
allows non-zero elements to have vector shapes and extends common sparse
operations, such as sparse-dense-matrix multiplication (SpMM), to operate on
this new form (as seen in the <code class="highlighter-rouge">bspmm</code> operation in the Graph Transformer
example).</li>
</ul>

<p>By utilizing these design features, DGL Sparse reduces code length by <strong>2.7 times</strong>
on average when compared to previous implementations of matrix-view models with
message passing interface. The simplified code also results in <strong>43% less
overhead</strong> in the framework. Additionally, DGL Sparse is PyTorch compatible,
making it easy to integrate with the various tools and packages available
within the PyTorch ecosystem.</p>

<h2 id="get-started-with-dgl-10">Get started with DGL 1.0</h2>

<p>The framework is readily available on all platforms and can be easily installed
using <a href="https://www.dgl.ai/pages/start.html">pip or conda</a>. To get started with DGL Sparse, check out the new
<a href="https://docs.dgl.ai/en/latest/notebooks/sparse/quickstart.html">Quickstart tutorial</a> and play with it in <a href="https://colab.research.google.com/github/dmlc/dgl/blob/master/notebooks/sparse/quickstart.ipynb">Google Colab</a> without having to set up a
local environment. In addition to the examples you’ve seen above, the first
release of DGL Sparse includes <a href="https://docs.dgl.ai/en/latest/notebooks/sparse/index.html">5 tutorials</a> and <a href="https://github.com/dmlc/dgl/tree/master/examples/sparse">11 end-to-end examples</a> to help
you learn and understand the different uses of this new package.</p>

<p>We welcome your feedback and are available via <a href="https://github.com/dmlc/dgl/issues">Github issues</a> and <a href="https://discuss.dgl.ai/">Discuss posts</a>.
Join our <a href="http://slack.dgl.ai/">Slack channel</a> to stay updated and to connect with the community.</p>

<p>For more information on the new additions and changes in DGL 1.0, please refer
to our <a href="https://github.com/dmlc/dgl/releases/tag/1.0.0">release note</a>.</p>

<p align="right"><em>(Banner image generated by Midjourney.)</em></p>
</p>
              <div class="blog-post-date">
                <p>20 <span>February</span> </p>
              </div>
              <div class="tag-links mt-30">
                <div class="widget">
                  <div class="tagcloud">
                    <a href="/tag/blog.html" class="set-2">blog</a> <a href="/tag/news.html" class="set-1">news</a> <a href="/tag/release.html" class="set-5">release</a>
                  </div>
                </div>
                <div class="blog-data">
                  <p>By 
                  
                  <a href="https://github.com/dmlc/dgl/">DGLTeam</a>,
                   in <a href="#">release</a> </p>
                </div>
              </div>
              <!-- Leave a Comment -->
              <div id="respond">
                <div class="comment-respond pb-50">
                  <div id='discourse-comments'></div>
                  <script type="text/javascript">
  DiscourseEmbed = { discourseUrl: 'https://discuss.dgl.ai/',
                     discourseEmbedUrl: 'https://www.dgl.ai/release/2023/02/20/release.html' };

  (function() {
    var d = document.createElement('script'); d.type = 'text/javascript'; d.async = true;
    d.src = DiscourseEmbed.discourseUrl + 'javascripts/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(d);
  })();
</script>

                </div>
              </div>
              <!-- End Leave a Comment -->
            </div>
          </div>
        </div>
      </div>
      <!-- End Blog Content -->
      <!-- Start Blog Sidebar -->
      <!--
      <div class="col-md-3">
        <div class="row">
          <div class="blog-sidebar">
            <div class="col-md-12 col-sm-6">
              <aside id="dwqa-categories-2" class="widget widget_categories dwqa_widget dwqa_widget_categories sidebar-list">
                <h4 class="list-title">Categories</h4>
<ul>
	
	
    
	 <li><a href="topics/AngularJS">AngularJS</a></li> 
	

</ul>



              </aside>
            </div>
            <div class="col-md-12 col-sm-6">
              <aside class="widget dwqa-widget dwqa-popular-question">
                <div class="sidebar-popular-post dwqa-popular-questions">
                  <div class="popular-questions"> 
<h2 class="widget-title">Popular Questions</h2>
<ul>

    

    
     <li><a href="/category_one/question_two">Can I Start Learning AngularJS Framework ?</a></li>
    
     <li><a href="/category_one/question_one">What is AngularJS ?</a></li>
    

    
    
     <li><a href="/category_two/question_three">How Can I Learning ReactJS Framework ?</a></li>
    
     <li><a href="/category_two/question_two">How Can I Learning ReactJS Framework ?</a></li>
    

    
    
     <li><a href="/category_three/question_three">Can I Learning EmberJS Framework ?</a></li>
    
     <li><a href="/category_three/question_two">How Can I Learning EmberJS Framework ?</a></li>
    

    
    
     <li><a href="/category_four/question_one">What is VueJS ?</a></li>
    
     <li><a href="/category_four/question_two">How Can I Learning VueJS Framework ?</a></li>
    

 </ul>
</div>
                </div>
              </aside>
            </div>
          </div>
        </div>
      </div>
      -->
      <!-- End Blog Sidebar -->
    </div>
  </div>
</section>
<!-- End Blog Area -->


    <!-- Start Footer Area -->
    <footer>
        <div class="footer-area themeix-ptb">
            <div class="container">
                <div class="row">
                    <div class="footer-wrapper">
                        <div class="col-sm-6 col-md-3">
                            <div class="single-footer">
                                <h3 class="footer-heading">Follow Us</h3>
                                <div class="single-footer-text">
                                    <p>Keep track the latest news, blogs and updates of DGL by following our social media accounts.</p>
                                </div>
                                <div class="social-links">
                                    <ul>
                                        <li><a href="https://twitter.com/GraphDeep"><i class="fa fa-twitter"></i></a></li>
                                        <li class="fb-link"><a href="https://www.facebook.com/GraphDeep/"><i class="fa fa-facebook"></i></a></li>
                                        <li><a href="/feed.xml"><i class="fa fa-rss"></i></a></li>
                                        <!--<li class="gp-link"><a href="#"><i class="fa fa-google-plus"></i></a></li>-->
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="single-footer">
                                <h3 class="footer-heading">Quick Links</h3>
                                <div class="footer-list">
                                    <ul>
                                        <li><a href="/pages/about.html">About us</a></li>
                                        <li><a href="/pages/start.html">Get started</a></li>
                                        <li><a href="https://github.com/dmlc/dgl/releases">Latest updates</a></li>
                                        <li><a href="/pages/index.html">Blogs</a></li>
                                        <li><a href="https://github.com/dmlc/dgl/">Github</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="single-footer">
                                <h3 class="footer-heading">Materials</h3>
                                <div class="footer-list">
                                    <ul>
                                        <li><a href="https://docs.dgl.ai/tutorials/models/index.html">Tutorials</a></li>
                                        <li><a href="https://discuss.dgl.ai">Discuss forum</a></li>
                                        <li><a href="https://github.com/dmlc/dgl/issues">Github issues</a></li>
                                        <li><a href="https://github.com/dmlc/dgl/blob/master/CONTRIBUTORS.md">Contributing</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-3">
                            <div class="single-footer">
                                <h3 class="footer-heading">Contact Us</h3>
                                <div class="subscribe-form">
                                    <form action="https://formspree.io/f/maylbdvy" method="POST">
                                        <input type="text" name="name" id="name" class="form-control" placeholder="Name" required>
                                        <input type="text" name="message" id="message" class="form-control" placeholder="Message" required>
                                        <input type="email" name="_replyto" id="email" class="form-control" placeholder="Email" required>
                                        <button type="submit" class="hover-bg">Submit</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Start Footer Bottom Area -->
        <!--
        <div class="footer-bottom-area themeix-pb">
            <div class="container">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="footer-bottom">
                            <div class="footer-logo">
                                <a href="#"><img src="/assets/images/footer-logo.png" alt="logo"></a>
                            </div>
                            <div class="footer-links">
                                <ul>
                                    <li><a href="#">Privacy Policy</a></li>
                                    <li><a href="#">Refund Policy</a></li>
                                    <li><a href="#">Disclaimer</a></li>
                                </ul>
                            </div>
                            <div class="copyright-text">
                                <p>All content Documenter &copy; 2017 - All rights reserved. - Proudly made with <a href="http://designingmarket.com">Designing Market</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        -->
        <!-- End Footer Bottom Area -->
        <!-- Start Scroll To Top -->
        <div class="scroll-top">
            <div class="scroll-icon">
                <i class="fa fa-angle-up"></i>
            </div>
        </div>
        <!-- End Scroll To Top -->
    </footer>
    <!-- End Footer Area -->

    <!-- jquery min -->
    <script src="/assets/js/jquery.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js"></script>
    

    <!-- Bootstrap Js -->
    <script src="/assets/js/bootstrap.min.js"></script>

    <!-- jQuery Easing -->
    <script src="/assets/js/jquery.easing.js"></script>

    <!-- Owl Carousel Js -->
    <script src="/assets/js/owl.carousel.min.js"></script>

    <!-- Google Map -->
    <!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAOCx7VEftKaGSK2F2p_tUKmMSdN00palo"></script> -->

    <!-- Mean Menu -->
    <script src="/assets/js/jquery.meanmenu.js"></script>

    <!-- Particles JS CDN -->
    <script src="/assets/js/particles.min.js"></script> 

    <!-- Main Js -->
    <script src="/assets/js/main.js"></script>

    <!-- MathJax Js -->
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
</body>

</html>
