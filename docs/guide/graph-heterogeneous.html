<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1.5 Heterogeneous Graphs &mdash; DGL 2.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=0bf289b5" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=9caaf7ed"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=ccdb6887"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1.6 Using DGLGraph on a GPU" href="graph-gpu.html" />
    <link rel="prev" title="1.4 Creating Graphs from External Sources" href="graph-external.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            DGL
          </a>
              <div class="version">
                2.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Install and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/blitz/index.html">A Blitz Introduction to DGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Materials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../stochastic_training/index.html">🆕 Stochastic Training of GNNs with GraphBolt</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="graph.html">Chapter 1: Graph</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="graph-basic.html">1.1 Some Basic Definitions about Graphs (Graphs 101)</a></li>
<li class="toctree-l3"><a class="reference internal" href="graph-graphs-nodes-edges.html">1.2 Graphs, Nodes, and Edges</a></li>
<li class="toctree-l3"><a class="reference internal" href="graph-feature.html">1.3 Node and Edge Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="graph-external.html">1.4 Creating Graphs from External Sources</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">1.5 Heterogeneous Graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="graph-gpu.html">1.6 Using DGLGraph on a GPU</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="message.html">Chapter 2: Message Passing</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn.html">Chapter 3: Building GNN Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">Chapter 4: Graph Data Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="training.html">Chapter 5: Training Graph Neural Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="minibatch.html">Chapter 6: Stochastic Training on Large Graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="distributed.html">Chapter 7: Distributed Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="mixed_precision.html">Chapter 8: Mixed Precision Training</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guide_cn/index.html">用户指南【包含过时信息】</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide_ko/index.html">사용자 가이드[시대에 뒤쳐진]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphtransformer/index.html">🆕 Tutorial: Graph Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/sparse/index.html">Tutorials: dgl.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cpu/index.html">Training on CPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/multi/index.html">Training on Multiple GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dist/index.html">Distributed training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/index.html">Paper Study with DGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.html">dgl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.data.html">dgl.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.dataloading.html">dgl.dataloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.DGLGraph.html">dgl.DGLGraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.distributed.html">dgl.distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.function.html">dgl.function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.geometry.html">dgl.geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.graphbolt.html">🆕 dgl.graphbolt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/nn-pytorch.html">dgl.nn (PyTorch)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/nn.functional.html">dgl.nn.functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.ops.html">dgl.ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.optim.html">dgl.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.sampling.html">dgl.sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.sparse_v0.html">dgl.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.multiprocessing.html">dgl.multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/transforms.html">dgl.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/udf.html">User-defined Functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contribute to DGL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/ffi.html">DGL Foreign Function Interface (FFI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html">Performance Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env_var.html">Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">Resources</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DGL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">User Guide</a></li>
          <li class="breadcrumb-item"><a href="graph.html">Chapter 1: Graph</a></li>
      <li class="breadcrumb-item active">1.5 Heterogeneous Graphs</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/guide/graph-heterogeneous.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="heterogeneous-graphs">
<span id="guide-graph-heterogeneous"></span><h1>1.5 Heterogeneous Graphs<a class="headerlink" href="#heterogeneous-graphs" title="Link to this heading"></a></h1>
<p><a class="reference internal" href="../guide_cn/graph-heterogeneous.html#guide-cn-graph-heterogeneous"><span class="std std-ref">(中文版)</span></a></p>
<p>A heterogeneous graph can have nodes and edges of different types. Nodes/Edges of
different types have independent ID space and feature storage. For example in the figure below, the
user and game node IDs both start from zero and they have different features.</p>
<figure class="align-default" id="id1">
<img alt="https://data.dgl.ai/asset/image/user_guide_graphch_2.png" src="https://data.dgl.ai/asset/image/user_guide_graphch_2.png" />
<figcaption>
<p><span class="caption-text">An example heterogeneous graph with two types of nodes (user and game) and two types of edges (follows and plays).</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="creating-a-heterogeneous-graph">
<h2>Creating a Heterogeneous Graph<a class="headerlink" href="#creating-a-heterogeneous-graph" title="Link to this heading"></a></h2>
<p>In DGL, a heterogeneous graph (heterograph for short) is specified with a series of graphs as below, one per
relation. Each relation is a string triplet <code class="docutils literal notranslate"><span class="pre">(source</span> <span class="pre">node</span> <span class="pre">type,</span> <span class="pre">edge</span> <span class="pre">type,</span> <span class="pre">destination</span> <span class="pre">node</span> <span class="pre">type)</span></code>.
Since relations disambiguate the edge types, DGL calls them canonical edge types.</p>
<p>The following code snippet is an example for creating a heterogeneous graph in DGL.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dgl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">th</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a heterograph with 3 node types and 3 edges types.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graph_data</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>   <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;interacts&#39;</span><span class="p">,</span> <span class="s1">&#39;drug&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])),</span>
<span class="gp">... </span>   <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;interacts&#39;</span><span class="p">,</span> <span class="s1">&#39;gene&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])),</span>
<span class="gp">... </span>   <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;treats&#39;</span><span class="p">,</span> <span class="s1">&#39;disease&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">]))</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">heterograph</span><span class="p">(</span><span class="n">graph_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">ntypes</span>
<span class="go">[&#39;disease&#39;, &#39;drug&#39;, &#39;gene&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">etypes</span>
<span class="go">[&#39;interacts&#39;, &#39;interacts&#39;, &#39;treats&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">canonical_etypes</span>
<span class="go">[(&#39;drug&#39;, &#39;interacts&#39;, &#39;drug&#39;),</span>
<span class="go"> (&#39;drug&#39;, &#39;interacts&#39;, &#39;gene&#39;),</span>
<span class="go"> (&#39;drug&#39;, &#39;treats&#39;, &#39;disease&#39;)]</span>
</pre></div>
</div>
<p>Note that homogeneous and bipartite graphs are just special heterogeneous graphs with one
relation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># A homogeneous graph</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dgl</span><span class="o">.</span><span class="n">heterograph</span><span class="p">({(</span><span class="s1">&#39;node_type&#39;</span><span class="p">,</span> <span class="s1">&#39;edge_type&#39;</span><span class="p">,</span> <span class="s1">&#39;node_type&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># A bipartite graph</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dgl</span><span class="o">.</span><span class="n">heterograph</span><span class="p">({(</span><span class="s1">&#39;source_type&#39;</span><span class="p">,</span> <span class="s1">&#39;edge_type&#39;</span><span class="p">,</span> <span class="s1">&#39;destination_type&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)})</span>
</pre></div>
</div>
<p>The <em>metagraph</em> associated with a heterogeneous graph is the schema of the graph. It specifies
type constraints on the sets of nodes and edges between the nodes. A node <span class="math notranslate nohighlight">\(u\)</span> in a metagraph
corresponds to a node type in the associated heterograph. An edge <span class="math notranslate nohighlight">\((u, v)\)</span> in a metagraph indicates that
there are edges from nodes of type <span class="math notranslate nohighlight">\(u\)</span> to nodes of type <span class="math notranslate nohighlight">\(v\)</span> in the associated heterograph.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span>
<span class="go">Graph(num_nodes={&#39;disease&#39;: 3, &#39;drug&#39;: 3, &#39;gene&#39;: 4},</span>
<span class="go">      num_edges={(&#39;drug&#39;, &#39;interacts&#39;, &#39;drug&#39;): 2,</span>
<span class="go">                 (&#39;drug&#39;, &#39;interacts&#39;, &#39;gene&#39;): 2,</span>
<span class="go">                 (&#39;drug&#39;, &#39;treats&#39;, &#39;disease&#39;): 1},</span>
<span class="go">      metagraph=[(&#39;drug&#39;, &#39;drug&#39;, &#39;interacts&#39;),</span>
<span class="go">                 (&#39;drug&#39;, &#39;gene&#39;, &#39;interacts&#39;),</span>
<span class="go">                 (&#39;drug&#39;, &#39;disease&#39;, &#39;treats&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">metagraph</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">OutMultiEdgeDataView([(&#39;drug&#39;, &#39;drug&#39;), (&#39;drug&#39;, &#39;gene&#39;), (&#39;drug&#39;, &#39;disease&#39;)])</span>
</pre></div>
</div>
<p>See APIs: <a class="reference internal" href="../generated/dgl.heterograph.html#dgl.heterograph" title="dgl.heterograph"><code class="xref py py-func docutils literal notranslate"><span class="pre">dgl.heterograph()</span></code></a>, <a class="reference internal" href="../generated/dgl.DGLGraph.ntypes.html#dgl.DGLGraph.ntypes" title="dgl.DGLGraph.ntypes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ntypes</span></code></a>, <a class="reference internal" href="../generated/dgl.DGLGraph.etypes.html#dgl.DGLGraph.etypes" title="dgl.DGLGraph.etypes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">etypes</span></code></a>,
<a class="reference internal" href="../generated/dgl.DGLGraph.canonical_etypes.html#dgl.DGLGraph.canonical_etypes" title="dgl.DGLGraph.canonical_etypes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">canonical_etypes</span></code></a>, <a class="reference internal" href="../generated/dgl.DGLGraph.metagraph.html#dgl.DGLGraph.metagraph" title="dgl.DGLGraph.metagraph"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metagraph</span></code></a>.</p>
</section>
<section id="working-with-multiple-types">
<h2>Working with Multiple Types<a class="headerlink" href="#working-with-multiple-types" title="Link to this heading"></a></h2>
<p>When multiple node/edge types are introduced, users need to specify the particular
node/edge type when invoking a DGLGraph API for type-specific information. In addition,
nodes/edges of different types have separate IDs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get the number of all nodes in the graph</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get the number of drug nodes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Nodes of different types have separate IDs,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># hence not well-defined without a type specified</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">()</span>
<span class="go">DGLError: Node type name must be specified if there are more than one node types.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">)</span>
<span class="go">tensor([0, 1, 2])</span>
</pre></div>
</div>
<p>To set/get features for a specific node/edge type, DGL provides two new types of syntax –
<cite>g.nodes[‘node_type’].data[‘feat_name’]</cite> and <cite>g.edges[‘edge_type’].data[‘feat_name’]</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set/get feature &#39;hv&#39; for nodes of type &#39;drug&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s1">&#39;drug&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;hv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s1">&#39;drug&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;hv&#39;</span><span class="p">]</span>
<span class="go">tensor([[1.],</span>
<span class="go">        [1.],</span>
<span class="go">        [1.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set/get feature &#39;he&#39; for edge of type &#39;treats&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;treats&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;treats&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">]</span>
<span class="go">tensor([[0.]])</span>
</pre></div>
</div>
<p>If the graph only has one node/edge type, there is no need to specify the node/edge type.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">heterograph</span><span class="p">({</span>
<span class="gp">... </span>   <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;interacts&#39;</span><span class="p">,</span> <span class="s1">&#39;drug&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])),</span>
<span class="gp">... </span>   <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;is similar&#39;</span><span class="p">,</span> <span class="s1">&#39;drug&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">()</span>
<span class="go">tensor([0, 1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># To set/get feature with a single type, no need to use the new syntax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;hv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the edge type uniquely determines the types of source and destination nodes, one
can just use one string instead of a string triplet to specify the edge type. For example, for a
heterograph with two relations <code class="docutils literal notranslate"><span class="pre">('user',</span> <span class="pre">'plays',</span> <span class="pre">'game')</span></code> and <code class="docutils literal notranslate"><span class="pre">('user',</span> <span class="pre">'likes',</span> <span class="pre">'game')</span></code>, it
is safe to just use <code class="docutils literal notranslate"><span class="pre">'plays'</span></code> or <code class="docutils literal notranslate"><span class="pre">'likes'</span></code> to refer to the two relations.</p>
</div>
</section>
<section id="loading-heterographs-from-disk">
<h2>Loading Heterographs from Disk<a class="headerlink" href="#loading-heterographs-from-disk" title="Link to this heading"></a></h2>
<section id="comma-separated-values-csv">
<h3>Comma Separated Values (CSV)<a class="headerlink" href="#comma-separated-values-csv" title="Link to this heading"></a></h3>
<p>A common way to store a heterograph is to store nodes and edges of different types in different CSV files.
An example is as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># data folder</span>
<span class="n">data</span><span class="o">/</span>
<span class="o">|--</span> <span class="n">drug</span><span class="o">.</span><span class="n">csv</span>        <span class="c1"># drug nodes</span>
<span class="o">|--</span> <span class="n">gene</span><span class="o">.</span><span class="n">csv</span>        <span class="c1"># gene nodes</span>
<span class="o">|--</span> <span class="n">disease</span><span class="o">.</span><span class="n">csv</span>     <span class="c1"># disease nodes</span>
<span class="o">|--</span> <span class="n">drug</span><span class="o">-</span><span class="n">interact</span><span class="o">-</span><span class="n">drug</span><span class="o">.</span><span class="n">csv</span>  <span class="c1"># drug-drug interaction edges</span>
<span class="o">|--</span> <span class="n">drug</span><span class="o">-</span><span class="n">interact</span><span class="o">-</span><span class="n">gene</span><span class="o">.</span><span class="n">csv</span>  <span class="c1"># drug-gene interaction edges</span>
<span class="o">|--</span> <span class="n">drug</span><span class="o">-</span><span class="n">treat</span><span class="o">-</span><span class="n">disease</span><span class="o">.</span><span class="n">csv</span>  <span class="c1"># drug-treat-disease edges</span>
</pre></div>
</div>
<p>Similar to the case of homogeneous graphs, one can use packages like Pandas to parse
CSV files into numpy arrays or framework tensors, build a relation dictionary and
construct a heterograph from that. The approach also applies to other popular formats like
GML/JSON.</p>
</section>
<section id="dgl-binary-format">
<h3>DGL Binary Format<a class="headerlink" href="#dgl-binary-format" title="Link to this heading"></a></h3>
<p>DGL provides <a class="reference internal" href="../generated/dgl.save_graphs.html#dgl.save_graphs" title="dgl.save_graphs"><code class="xref py py-func docutils literal notranslate"><span class="pre">dgl.save_graphs()</span></code></a> and <a class="reference internal" href="../generated/dgl.load_graphs.html#dgl.load_graphs" title="dgl.load_graphs"><code class="xref py py-func docutils literal notranslate"><span class="pre">dgl.load_graphs()</span></code></a> respectively for saving
heterogeneous graphs in binary format and loading them from binary format.</p>
</section>
</section>
<section id="edge-type-subgraph">
<h2>Edge Type Subgraph<a class="headerlink" href="#edge-type-subgraph" title="Link to this heading"></a></h2>
<p>One can create a subgraph of a heterogeneous graph by specifying the relations to retain, with
features copied if any.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">heterograph</span><span class="p">({</span>
<span class="gp">... </span>   <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;interacts&#39;</span><span class="p">,</span> <span class="s1">&#39;drug&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])),</span>
<span class="gp">... </span>   <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;interacts&#39;</span><span class="p">,</span> <span class="s1">&#39;gene&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])),</span>
<span class="gp">... </span>   <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;treats&#39;</span><span class="p">,</span> <span class="s1">&#39;disease&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">]))</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s1">&#39;drug&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;hv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Retain relations (&#39;drug&#39;, &#39;interacts&#39;, &#39;drug&#39;) and (&#39;drug&#39;, &#39;treats&#39;, &#39;disease&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># All nodes for &#39;drug&#39; and &#39;disease&#39; will be retained</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eg</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">edge_type_subgraph</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;interacts&#39;</span><span class="p">,</span> <span class="s1">&#39;drug&#39;</span><span class="p">),</span>
<span class="gp">... </span>                                <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;treats&#39;</span><span class="p">,</span> <span class="s1">&#39;disease&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eg</span>
<span class="go">Graph(num_nodes={&#39;disease&#39;: 3, &#39;drug&#39;: 3},</span>
<span class="go">      num_edges={(&#39;drug&#39;, &#39;interacts&#39;, &#39;drug&#39;): 2, (&#39;drug&#39;, &#39;treats&#39;, &#39;disease&#39;): 1},</span>
<span class="go">      metagraph=[(&#39;drug&#39;, &#39;drug&#39;, &#39;interacts&#39;), (&#39;drug&#39;, &#39;disease&#39;, &#39;treats&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The associated features will be copied as well</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eg</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s1">&#39;drug&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;hv&#39;</span><span class="p">]</span>
<span class="go">tensor([[1.],</span>
<span class="go">        [1.],</span>
<span class="go">        [1.]])</span>
</pre></div>
</div>
</section>
<section id="converting-heterogeneous-graphs-to-homogeneous-graphs">
<h2>Converting Heterogeneous Graphs to Homogeneous Graphs<a class="headerlink" href="#converting-heterogeneous-graphs-to-homogeneous-graphs" title="Link to this heading"></a></h2>
<p>Heterographs provide a clean interface for managing nodes/edges of different types and
their associated features. This is particularly helpful when:</p>
<ol class="arabic simple">
<li><p>The features for nodes/edges of different types have different data types or sizes.</p></li>
<li><p>We want to apply different operations to nodes/edges of different types.</p></li>
</ol>
<p>If the above conditions do not hold and one does not want to distinguish node/edge types in
modeling, then DGL allows converting a heterogeneous graph to a homogeneous graph with <code class="xref py py-func docutils literal notranslate"><span class="pre">dgl.DGLGraph.to_homogeneous()</span></code> API.
It proceeds as follows:</p>
<ol class="arabic simple">
<li><p>Relabels nodes/edges of all types using consecutive integers starting from 0</p></li>
<li><p>Merges the features across node/edge types specified by the user.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">heterograph</span><span class="p">({</span>
<span class="gp">... </span>   <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;interacts&#39;</span><span class="p">,</span> <span class="s1">&#39;drug&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])),</span>
<span class="gp">... </span>   <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;treats&#39;</span><span class="p">,</span> <span class="s1">&#39;disease&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">]))})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s1">&#39;drug&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;hv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s1">&#39;disease&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;hv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;interacts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;treats&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># By default, it does not merge any features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hg</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">to_homogeneous</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;hv&#39;</span> <span class="ow">in</span> <span class="n">hg</span><span class="o">.</span><span class="n">ndata</span>
<span class="go">False</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Copy edge features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># For feature copy, it expects features to have</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># the same size and dtype across node/edge types</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hg</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">to_homogeneous</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">edata</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;he&#39;</span><span class="p">])</span>
<span class="go">DGLError: Cannot concatenate column ‘he’ with shape Scheme(shape=(2,), dtype=torch.float32) and shape Scheme(shape=(1,), dtype=torch.float32)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Copy node features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hg</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">to_homogeneous</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">ndata</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;hv&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hg</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;hv&#39;</span><span class="p">]</span>
<span class="go">tensor([[1.],</span>
<span class="go">        [1.],</span>
<span class="go">        [1.],</span>
<span class="go">        [0.],</span>
<span class="go">        [0.],</span>
<span class="go">        [0.]])</span>
</pre></div>
</div>
<p>The original node/edge types and type-specific IDs are stored in <a class="reference internal" href="../generated/dgl.DGLGraph.ndata.html#dgl.DGLGraph.ndata" title="dgl.DGLGraph.ndata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ndata</span></code></a> and <a class="reference internal" href="../generated/dgl.DGLGraph.edata.html#dgl.DGLGraph.edata" title="dgl.DGLGraph.edata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">edata</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Order of node types in the heterograph</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">ntypes</span>
<span class="go">[&#39;disease&#39;, &#39;drug&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Original node types</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hg</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="n">dgl</span><span class="o">.</span><span class="n">NTYPE</span><span class="p">]</span>
<span class="go">tensor([0, 0, 0, 1, 1, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Original type-specific node IDs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hg</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="n">dgl</span><span class="o">.</span><span class="n">NID</span><span class="p">]</span>
<span class="go">tensor([0, 1, 2, 0, 1, 2])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Order of edge types in the heterograph</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">etypes</span>
<span class="go">[&#39;interacts&#39;, &#39;treats&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Original edge types</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hg</span><span class="o">.</span><span class="n">edata</span><span class="p">[</span><span class="n">dgl</span><span class="o">.</span><span class="n">ETYPE</span><span class="p">]</span>
<span class="go">tensor([0, 0, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Original type-specific edge IDs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hg</span><span class="o">.</span><span class="n">edata</span><span class="p">[</span><span class="n">dgl</span><span class="o">.</span><span class="n">EID</span><span class="p">]</span>
<span class="go">tensor([0, 1, 0])</span>
</pre></div>
</div>
<p>For modeling purposes, one may want to group some relations together and apply the same
operation to them. To address this need, one can first take an edge type subgraph of the
heterograph and then convert the subgraph to a homogeneous graph.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">heterograph</span><span class="p">({</span>
<span class="gp">... </span>   <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;interacts&#39;</span><span class="p">,</span> <span class="s1">&#39;drug&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])),</span>
<span class="gp">... </span>   <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;interacts&#39;</span><span class="p">,</span> <span class="s1">&#39;gene&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])),</span>
<span class="gp">... </span>   <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;treats&#39;</span><span class="p">,</span> <span class="s1">&#39;disease&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="n">th</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">]))</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">edge_type_subgraph</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;interacts&#39;</span><span class="p">,</span> <span class="s1">&#39;drug&#39;</span><span class="p">),</span>
<span class="gp">... </span>                                   <span class="p">(</span><span class="s1">&#39;drug&#39;</span><span class="p">,</span> <span class="s1">&#39;interacts&#39;</span><span class="p">,</span> <span class="s1">&#39;gene&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_sub_g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">to_homogeneous</span><span class="p">(</span><span class="n">sub_g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_sub_g</span>
<span class="go">Graph(num_nodes=7, num_edges=4,</span>
<span class="go">      ...)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="graph-external.html" class="btn btn-neutral float-left" title="1.4 Creating Graphs from External Sources" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="graph-gpu.html" class="btn btn-neutral float-right" title="1.6 Using DGLGraph on a GPU" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, DGL Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>