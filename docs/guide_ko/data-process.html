<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4.3 데이터 프로세싱 &mdash; DGL 2.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=0bf289b5" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=9caaf7ed"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=ccdb6887"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.4 데이터 저장과 로딩" href="data-savenload.html" />
    <link rel="prev" title="4.2 Raw 데이터 다운로드하기 (optional)" href="data-download.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            DGL
          </a>
              <div class="version">
                2.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Install and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/blitz/index.html">A Blitz Introduction to DGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Materials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../stochastic_training/index.html">🆕 Stochastic Training of GNNs with GraphBolt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide_cn/index.html">用户指南【包含过时信息】</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">사용자 가이드[시대에 뒤쳐진]</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="graph.html">1장: 그래프</a></li>
<li class="toctree-l2"><a class="reference internal" href="message.html">2장: 메지시 전달(Message Passing)</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn.html">3장: GNN 모듈 만들기</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="data.html">4장: 그래프 데이터 파이프라인</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="data-dataset.html">4.1 DGLDataset 클래스</a></li>
<li class="toctree-l3"><a class="reference internal" href="data-download.html">4.2 Raw 데이터 다운로드하기 (optional)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.3 데이터 프로세싱</a></li>
<li class="toctree-l3"><a class="reference internal" href="data-savenload.html">4.4 데이터 저장과 로딩</a></li>
<li class="toctree-l3"><a class="reference internal" href="data-loadogb.html">4.5 <code class="docutils literal notranslate"><span class="pre">ogb</span></code> 패키지를 사용해서 OGB 데이터셋들 로드하기</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="training.html">5장: 그래프 뉴럴 네트워크 학습하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="minibatch.html">6장: 큰 그래프에 대한 stochastic 학습</a></li>
<li class="toctree-l2"><a class="reference internal" href="distributed.html">7장: 분산 학습</a></li>
<li class="toctree-l2"><a class="reference internal" href="mixed_precision.html">8장: Mixed Precision 학습</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../graphtransformer/index.html">🆕 Tutorial: Graph Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/sparse/index.html">Tutorials: dgl.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cpu/index.html">Training on CPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/multi/index.html">Training on Multiple GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dist/index.html">Distributed training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/index.html">Paper Study with DGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.html">dgl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.data.html">dgl.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.dataloading.html">dgl.dataloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.DGLGraph.html">dgl.DGLGraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.distributed.html">dgl.distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.function.html">dgl.function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.geometry.html">dgl.geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.graphbolt.html">🆕 dgl.graphbolt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/nn-pytorch.html">dgl.nn (PyTorch)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/nn.functional.html">dgl.nn.functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.ops.html">dgl.ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.optim.html">dgl.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.sampling.html">dgl.sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.sparse_v0.html">dgl.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.multiprocessing.html">dgl.multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/transforms.html">dgl.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/udf.html">User-defined Functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contribute to DGL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/ffi.html">DGL Foreign Function Interface (FFI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html">Performance Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env_var.html">Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">Resources</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DGL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">사용자 가이드[시대에 뒤쳐진]</a></li>
          <li class="breadcrumb-item"><a href="data.html">4장: 그래프 데이터 파이프라인</a></li>
      <li class="breadcrumb-item active">4.3 데이터 프로세싱</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/guide_ko/data-process.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="guide-ko-data-pipeline-process">
<span id="id1"></span><h1>4.3 데이터 프로세싱<a class="headerlink" href="#guide-ko-data-pipeline-process" title="Link to this heading"></a></h1>
<p><a class="reference internal" href="../guide/data-process.html#guide-data-pipeline-process"><span class="std std-ref">(English Version)</span></a></p>
<p>데이터 프로세싱 코드를 <code class="docutils literal notranslate"><span class="pre">process()</span></code> 함수에 구현할 수 있으며, 이때 처리되지 않은 데이터는 <code class="docutils literal notranslate"><span class="pre">self.raw_dir</span></code> 디렉토리에 있어야 한다. 그래프 머신러닝에는 일반적으로 3가지 종류의 일이 있다: 그래프 분류, 노드 분류, 그리고 링크 예측. 이 절에서는 이 일들에 관련된 데이터셋 처리 방법을 설명한다.</p>
<p>이 절에서 그래프들, 피쳐들, 그리고 마스크들을 처리하는 표준 방법에 집중해서 알아본다. 빌트인 데이터셋을 예제로 사용할 것이고, 파일로 부터 그래프를 만드는 방법은 생략한다. 하지만, 이와 관련된 구현에 대한 링크를 제공할 것이다. 외부 소스들로 부터 그래프를 만드는 방법에 대한 완벽한 가이드는 <a class="reference internal" href="graph-external.html#guide-ko-graph-external"><span class="std std-ref">1.4 외부 소스를 사용한 그래프 생성하기</span></a> 를 참고하자.</p>
<section id="id2">
<h2>그래프 분류 데이터셋 프로세싱<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<p>그래프 분류 데이터셋은 미니-배치 학습이 사용되는 전형적인 머신러닝 테스크에서 사용되는 데이터셋과 거의 동일하다. 즉, 처리되지 않은 데이터는 <a class="reference internal" href="../api/python/dgl.DGLGraph.html#dgl.DGLGraph" title="dgl.DGLGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">dgl.DGLGraph</span></code></a> 객체들의 리스트와 레이블 텐서들의 리스트로 변환하면 된다. 또한, 만약 처리되지 않은 데이터가 여러 파일들로 나눠져 있을 경우에는, 데이터의 특정 부분을 로드하기 위해서 <code class="docutils literal notranslate"><span class="pre">split</span></code>  파라메터를 더할 수 있다.</p>
<p><a class="reference internal" href="../generated/dgl.data.QM7bDataset.html#dgl.data.QM7bDataset" title="dgl.data.QM7bDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">QM7bDataset</span></code></a> 를 예로 살펴보자:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dgl.data</span> <span class="kn">import</span> <span class="n">DGLDataset</span>

<span class="k">class</span> <span class="nc">QM7bDataset</span><span class="p">(</span><span class="n">DGLDataset</span><span class="p">):</span>
    <span class="n">_url</span> <span class="o">=</span> <span class="s1">&#39;http://deepchem.io.s3-website-us-west-1.amazonaws.com/&#39;</span> \
           <span class="s1">&#39;datasets/qm7b.mat&#39;</span>
    <span class="n">_sha1_str</span> <span class="o">=</span> <span class="s1">&#39;4102c744bb9d6fd7b40ac67a300e49cd87e28392&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_reload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QM7bDataset</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;qm7b&#39;</span><span class="p">,</span>
                                          <span class="n">url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">,</span>
                                          <span class="n">raw_dir</span><span class="o">=</span><span class="n">raw_dir</span><span class="p">,</span>
                                          <span class="n">force_reload</span><span class="o">=</span><span class="n">force_reload</span><span class="p">,</span>
                                          <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mat_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_path</span> <span class="o">+</span> <span class="s1">&#39;.mat&#39;</span>
        <span class="c1"># process data to a list of graphs and a list of labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_graph</span><span class="p">(</span><span class="n">mat_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get graph and label by index</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idx : int</span>
<span class="sd">            Item index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        (dgl.DGLGraph, Tensor)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of graphs in the dataset&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">process()</span></code> 함수에서 처리되지 않은 데이터는 그래프들의 리스트와 레이블들의 리스트로 변환된다. Iteration을 위해서 <code class="docutils literal notranslate"><span class="pre">__getitem__(idx)</span></code> 와 <code class="docutils literal notranslate"><span class="pre">__len__()</span></code> 를 구현해야 한다. 위의 예제에서와 같이, DGL에서는 <code class="docutils literal notranslate"><span class="pre">__getitem__(idx)</span></code> 가 <code class="docutils literal notranslate"><span class="pre">(graph,</span> <span class="pre">label)</span></code> tuple을 리턴하도록 권장한다. <code class="docutils literal notranslate"><span class="pre">self._load_graph()</span></code> 와 <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> 함수의 구체적인 구현은 <a class="reference external" href="https://docs.dgl.ai/en/0.5.x/_modules/dgl/data/qm7b.html#QM7bDataset">QM7bDataset source
code</a> 를 확인하자.</p>
<p>데이터셋의 유용한 정보들을 지정하기 위해서 클래스에 프로퍼티들을 추가하는 것이 가능하다. <a class="reference internal" href="../generated/dgl.data.QM7bDataset.html#dgl.data.QM7bDataset" title="dgl.data.QM7bDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">QM7bDataset</span></code></a> 에 이 멀티 테스크 데이터셋의 예측 테스트의 총 개숫를 지정하기 위해 <code class="docutils literal notranslate"><span class="pre">num_tasks</span></code> 라는 프로퍼티를 추가할 수 있다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">num_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Number of labels for each graph, i.e. number of prediction tasks.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">14</span>
</pre></div>
</div>
<p>구현 코드를 마친 후에, <a class="reference internal" href="../generated/dgl.data.QM7bDataset.html#dgl.data.QM7bDataset" title="dgl.data.QM7bDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">QM7bDataset</span></code></a> 를 다음과 같이 사용한다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dgl</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="kn">from</span> <span class="nn">dgl.dataloading</span> <span class="kn">import</span> <span class="n">GraphDataLoader</span>

<span class="c1"># load data</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">QM7bDataset</span><span class="p">()</span>
<span class="n">num_tasks</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">num_tasks</span>

<span class="c1"># create dataloaders</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">GraphDataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># training</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
        <span class="c1"># your training code here</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>그래프 분류 모델 학습에 대한 전체 가이드는 <a class="reference internal" href="training-graph.html#guide-ko-training-graph-classification"><span class="std std-ref">5.4 그래프 분류</span></a> 를 참고하자.</p>
<p>DGL의 빌트인 그래프 분류 데이터셋을 참고하면 그래프 분류 데이터셋의 더 많은 예들을 확인할 수 있다.</p>
<ul class="simple">
<li><p><span class="xref std std-ref">gindataset</span></p></li>
<li><p><span class="xref std std-ref">minigcdataset</span></p></li>
<li><p><span class="xref std std-ref">qm7bdata</span></p></li>
<li><p><span class="xref std std-ref">tudata</span></p></li>
</ul>
</section>
<section id="id3">
<h2>노드 분류 데이터셋 프로세싱<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<p>그래프 분류와는 다르게 노드 분류는 일번적으로 단일 그래프에서 이뤄진다. 따라서, 데이터셋의 분할(split)은 그래프 노드에서 일어난다. DGL은 노드 마스크를 사용해서 분할을 지정하는 것을 권장한다. 이 절에서는 빌트인 데이터셋 <a class="reference external" href="https://docs.dgl.ai/en/0.5.x/_modules/dgl/data/citation_graph.html#CitationGraphDataset">CitationGraphDataset</a> 을 예로 들겠다.</p>
<p>추가로, DGL은 노드들와 에지들이 서로 가까운 ID값들이 서로 가까운 범위에 있도록 재배열하는 것을 권장한다. 이 절차는 노드의 neighbor들에 대한 접근성을 향상시켜서, 이 후의 연산 및 그래프에 대한 분석을 빠르게 하기 위함이다. 이를 위해서 DGL은 <a class="reference internal" href="../generated/dgl.reorder_graph.html#dgl.reorder_graph" title="dgl.reorder_graph"><code class="xref py py-func docutils literal notranslate"><span class="pre">dgl.reorder_graph()</span></code></a> API를 제공한다. 더 자세한 내용은 다음 예제의 <code class="docutils literal notranslate"><span class="pre">process()</span></code> 를 참고하자.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dgl.data</span> <span class="kn">import</span> <span class="n">DGLBuiltinDataset</span>
<span class="kn">from</span> <span class="nn">dgl.data.utils</span> <span class="kn">import</span> <span class="n">_get_dgl_url</span>

<span class="k">class</span> <span class="nc">CitationGraphDataset</span><span class="p">(</span><span class="n">DGLBuiltinDataset</span><span class="p">):</span>
    <span class="n">_urls</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;cora_v2&#39;</span> <span class="p">:</span> <span class="s1">&#39;dataset/cora_v2.zip&#39;</span><span class="p">,</span>
        <span class="s1">&#39;citeseer&#39;</span> <span class="p">:</span> <span class="s1">&#39;dataset/citeseer.zip&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pubmed&#39;</span> <span class="p">:</span> <span class="s1">&#39;dataset/pubmed.zip&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">raw_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_reload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;cora&#39;</span><span class="p">,</span> <span class="s1">&#39;citeseer&#39;</span><span class="p">,</span> <span class="s1">&#39;pubmed&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;cora&#39;</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;cora_v2&#39;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">_get_dgl_url</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_urls</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CitationGraphDataset</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span>
                                                   <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                                                   <span class="n">raw_dir</span><span class="o">=</span><span class="n">raw_dir</span><span class="p">,</span>
                                                   <span class="n">force_reload</span><span class="o">=</span><span class="n">force_reload</span><span class="p">,</span>
                                                   <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Skip some processing code</span>
        <span class="c1"># === data processing skipped ===</span>

        <span class="c1"># build graph</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">graph</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
        <span class="c1"># splitting masks</span>
        <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;train_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_mask</span>
        <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;val_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_mask</span>
        <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;test_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_mask</span>
        <span class="c1"># node labels</span>
        <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="c1"># node features</span>
        <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">_preprocess_features</span><span class="p">(</span><span class="n">features</span><span class="p">),</span>
                                       <span class="n">dtype</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">data_type_dict</span><span class="p">[</span><span class="s1">&#39;float32&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_tasks</span> <span class="o">=</span> <span class="n">onehot_labels</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="n">labels</span>
        <span class="c1"># reorder graph to obtain better locality.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">reorder_graph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;This dataset has only one graph&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_g</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span>
</pre></div>
</div>
<p>분류 데이터셋 프로세싱 코드의 중요한 부분(마스크 분할하기)을 강조하기 위해서 <code class="docutils literal notranslate"><span class="pre">process()</span></code> 함수의 코드 일부는 생략해서 간략하게 만들었다.</p>
<p>일반적으로 노드 분류 테스크에서 하나의 그래프만 사용되기 때문에, <code class="docutils literal notranslate"><span class="pre">__getitem__(idx)</span></code> 와 <code class="docutils literal notranslate"><span class="pre">__len__()</span></code> 함수 구현이 바뀐 점을 알아두자. 마스크는 PyTorch와 TensorFlow에서는 <code class="docutils literal notranslate"><span class="pre">bool</span> <span class="pre">tensors</span></code> 이고 MXNet에서는 <code class="docutils literal notranslate"><span class="pre">float</span> <span class="pre">tensors</span></code> 이다.</p>
<p>다음 예는  <code class="docutils literal notranslate"><span class="pre">CitationGraphDataset</span></code> 의 서브 클래스인 <a class="reference internal" href="../generated/dgl.data.CiteseerGraphDataset.html#dgl.data.CiteseerGraphDataset" title="dgl.data.CiteseerGraphDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">dgl.data.CiteseerGraphDataset</span></code></a> 를 사용하는 방법이다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># load data</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">CiteseerGraphDataset</span><span class="p">(</span><span class="n">raw_dir</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># get split masks</span>
<span class="n">train_mask</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;train_mask&#39;</span><span class="p">]</span>
<span class="n">val_mask</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;val_mask&#39;</span><span class="p">]</span>
<span class="n">test_mask</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;test_mask&#39;</span><span class="p">]</span>

<span class="c1"># get node features</span>
<span class="n">feats</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">]</span>

<span class="c1"># get labels</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>노드 분류 모델에 대한 전체 가이드는 <a class="reference internal" href="training-node.html#guide-ko-training-node-classification"><span class="std std-ref">5.1 노드 분류/리그래션(Regression)</span></a> 를 참고하자.</p>
<p>DGL의 빌트인 데이터셋들은 노드 분류 데이터셋의 여러 예제들을 포함하고 있다.</p>
<ul class="simple">
<li><p><span class="xref std std-ref">citationdata</span></p></li>
<li><p><span class="xref std std-ref">corafulldata</span></p></li>
<li><p><span class="xref std std-ref">amazoncobuydata</span></p></li>
<li><p><span class="xref std std-ref">coauthordata</span></p></li>
<li><p><span class="xref std std-ref">karateclubdata</span></p></li>
<li><p><span class="xref std std-ref">ppidata</span></p></li>
<li><p><span class="xref std std-ref">redditdata</span></p></li>
<li><p><span class="xref std std-ref">sbmdata</span></p></li>
<li><p><span class="xref std std-ref">sstdata</span></p></li>
<li><p><span class="xref std std-ref">rdfdata</span></p></li>
</ul>
</section>
<section id="id4">
<h2>링크 예측 데이터셋 프로세싱<a class="headerlink" href="#id4" title="Link to this heading"></a></h2>
<p>링크 예측 데이테셋을 프로세싱하는 것은 주로 데이터셋에 하나의 그래프만 있기 때문에, 노드 분류의 경우와 비슷하다.</p>
<p>예제로 <a class="reference external" href="https://docs.dgl.ai/en/0.5.x/_modules/dgl/data/knowledge_graph.html#KnowledgeGraphDataset">KnowledgeGraphDataset</a> 빌트인 데이터셋을 사용하는데, 링크 예측 데이터셋 프로세싱의 주요 부분을 강조하기 위해서 자세한 데이터 프로세싱 코드는 생략했다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example for creating Link Prediction datasets</span>
<span class="k">class</span> <span class="nc">KnowledgeGraphDataset</span><span class="p">(</span><span class="n">DGLBuiltinDataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">raw_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_reload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span> <span class="o">=</span> <span class="n">reverse</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">_get_dgl_url</span><span class="p">(</span><span class="s1">&#39;dataset/&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.tgz&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">KnowledgeGraphDataset</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span>
                                                    <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                                                    <span class="n">raw_dir</span><span class="o">=</span><span class="n">raw_dir</span><span class="p">,</span>
                                                    <span class="n">force_reload</span><span class="o">=</span><span class="n">force_reload</span><span class="p">,</span>
                                                    <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Skip some processing code</span>
        <span class="c1"># === data processing skipped ===</span>

        <span class="c1"># splitting mask</span>
        <span class="n">g</span><span class="o">.</span><span class="n">edata</span><span class="p">[</span><span class="s1">&#39;train_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_mask</span>
        <span class="n">g</span><span class="o">.</span><span class="n">edata</span><span class="p">[</span><span class="s1">&#39;val_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_mask</span>
        <span class="n">g</span><span class="o">.</span><span class="n">edata</span><span class="p">[</span><span class="s1">&#39;test_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_mask</span>
        <span class="c1"># edge type</span>
        <span class="n">g</span><span class="o">.</span><span class="n">edata</span><span class="p">[</span><span class="s1">&#39;etype&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">etype</span>
        <span class="c1"># node type</span>
        <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;ntype&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ntype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_g</span> <span class="o">=</span> <span class="n">g</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;This dataset has only one graph&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_g</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span>
</pre></div>
</div>
<p>위 코드에서 볼 수 있듯이 분할 마스크들을 그래프의 <code class="docutils literal notranslate"><span class="pre">edata</span></code> 필드에 추가한다. 전체 구현은  <a class="reference external" href="https://docs.dgl.ai/en/0.5.x/_modules/dgl/data/knowledge_graph.html#KnowledgeGraphDataset">KnowledgeGraphDataset 소스 코드</a> 를 참고하자.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dgl.data</span> <span class="kn">import</span> <span class="n">FB15k237Dataset</span>

<span class="c1"># load data</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">FB15k237Dataset</span><span class="p">()</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># get training mask</span>
<span class="n">train_mask</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">edata</span><span class="p">[</span><span class="s1">&#39;train_mask&#39;</span><span class="p">]</span>
<span class="n">train_idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">train_mask</span><span class="p">,</span> <span class="n">as_tuple</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">src</span><span class="p">,</span> <span class="n">dst</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">train_idx</span><span class="p">)</span>
<span class="c1"># get edge types in training set</span>
<span class="n">rel</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">edata</span><span class="p">[</span><span class="s1">&#39;etype&#39;</span><span class="p">][</span><span class="n">train_idx</span><span class="p">]</span>
</pre></div>
</div>
<p>링크 예측 모델에 대한 전체 가이드는 <a class="reference internal" href="training-link.html#guide-ko-training-link-prediction"><span class="std std-ref">5.3 링크 예측</span></a> 에 있다.</p>
<p>DGL의 빌트인 데이터셋들은 링크 예측 데이터셋의 여러 예제들을 포함하고 있다.</p>
<ul class="simple">
<li><p><span class="xref std std-ref">kgdata</span></p></li>
<li><p><span class="xref std std-ref">bitcoinotcdata</span></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="data-download.html" class="btn btn-neutral float-left" title="4.2 Raw 데이터 다운로드하기 (optional)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="data-savenload.html" class="btn btn-neutral float-right" title="4.4 데이터 저장과 로딩" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, DGL Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>