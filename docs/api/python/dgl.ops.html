<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dgl.ops &mdash; DGL 2.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=0bf289b5" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=9caaf7ed"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=ccdb6887"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="dgl.ops.gspmm" href="../../generated/dgl.ops.gspmm.html" />
    <link rel="prev" title="dgl.nn.functional" href="nn.functional.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            DGL
          </a>
              <div class="version">
                2.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Install and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/blitz/index.html">A Blitz Introduction to DGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Materials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../stochastic_training/index.html">🆕 Stochastic Training of GNNs with GraphBolt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guide_cn/index.html">用户指南【包含过时信息】</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guide_ko/index.html">사용자 가이드[시대에 뒤쳐진]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../graphtransformer/index.html">🆕 Tutorial: Graph Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/sparse/index.html">Tutorials: dgl.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/cpu/index.html">Training on CPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/multi/index.html">Training on Multiple GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/dist/index.html">Distributed training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/models/index.html">Paper Study with DGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dgl.html">dgl</a></li>
<li class="toctree-l1"><a class="reference internal" href="dgl.data.html">dgl.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="dgl.dataloading.html">dgl.dataloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="dgl.DGLGraph.html">dgl.DGLGraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="dgl.distributed.html">dgl.distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="dgl.function.html">dgl.function</a></li>
<li class="toctree-l1"><a class="reference internal" href="dgl.geometry.html">dgl.geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="dgl.graphbolt.html">🆕 dgl.graphbolt</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn-pytorch.html">dgl.nn (PyTorch)</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn.functional.html">dgl.nn.functional</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">dgl.ops</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#gspmm-functions">GSpMM functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.gspmm.html">dgl.ops.gspmm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_add_e_sum.html">dgl.ops.u_add_e_sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_sub_e_sum.html">dgl.ops.u_sub_e_sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_mul_e_sum.html">dgl.ops.u_mul_e_sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_div_e_sum.html">dgl.ops.u_div_e_sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_add_e_max.html">dgl.ops.u_add_e_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_sub_e_max.html">dgl.ops.u_sub_e_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_mul_e_max.html">dgl.ops.u_mul_e_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_div_e_max.html">dgl.ops.u_div_e_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_add_e_min.html">dgl.ops.u_add_e_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_sub_e_min.html">dgl.ops.u_sub_e_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_mul_e_min.html">dgl.ops.u_mul_e_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_div_e_min.html">dgl.ops.u_div_e_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_add_e_mean.html">dgl.ops.u_add_e_mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_sub_e_mean.html">dgl.ops.u_sub_e_mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_mul_e_mean.html">dgl.ops.u_mul_e_mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_div_e_mean.html">dgl.ops.u_div_e_mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.copy_u_sum.html">dgl.ops.copy_u_sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.copy_e_sum.html">dgl.ops.copy_e_sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.copy_u_max.html">dgl.ops.copy_u_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.copy_e_max.html">dgl.ops.copy_e_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.copy_u_min.html">dgl.ops.copy_u_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.copy_e_min.html">dgl.ops.copy_e_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.copy_u_mean.html">dgl.ops.copy_u_mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.copy_e_mean.html">dgl.ops.copy_e_mean</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gsddmm-functions">GSDDMM functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.gsddmm.html">dgl.ops.gsddmm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_add_v.html">dgl.ops.u_add_v</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_sub_v.html">dgl.ops.u_sub_v</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_mul_v.html">dgl.ops.u_mul_v</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_dot_v.html">dgl.ops.u_dot_v</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_div_v.html">dgl.ops.u_div_v</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_add_e.html">dgl.ops.u_add_e</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_sub_e.html">dgl.ops.u_sub_e</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_mul_e.html">dgl.ops.u_mul_e</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_dot_e.html">dgl.ops.u_dot_e</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.u_div_e.html">dgl.ops.u_div_e</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.e_add_v.html">dgl.ops.e_add_v</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.e_sub_v.html">dgl.ops.e_sub_v</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.e_mul_v.html">dgl.ops.e_mul_v</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.e_dot_v.html">dgl.ops.e_dot_v</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.e_div_v.html">dgl.ops.e_div_v</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.v_add_u.html">dgl.ops.v_add_u</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.v_sub_u.html">dgl.ops.v_sub_u</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.v_mul_u.html">dgl.ops.v_mul_u</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.v_dot_u.html">dgl.ops.v_dot_u</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.v_div_u.html">dgl.ops.v_div_u</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.e_add_u.html">dgl.ops.e_add_u</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.e_sub_u.html">dgl.ops.e_sub_u</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.e_mul_u.html">dgl.ops.e_mul_u</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.e_dot_u.html">dgl.ops.e_dot_u</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.e_div_u.html">dgl.ops.e_div_u</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.v_add_e.html">dgl.ops.v_add_e</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.v_sub_e.html">dgl.ops.v_sub_e</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.v_mul_e.html">dgl.ops.v_mul_e</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.v_dot_e.html">dgl.ops.v_dot_e</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.v_div_e.html">dgl.ops.v_div_e</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.copy_u.html">dgl.ops.copy_u</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.copy_v.html">dgl.ops.copy_v</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#segment-reduce-module">Segment Reduce Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.segment_reduce.html">dgl.ops.segment_reduce</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gathermm-and-segmentmm-module">GatherMM and SegmentMM Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.gather_mm.html">dgl.ops.gather_mm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/dgl.ops.segment_mm.html">dgl.ops.segment_mm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#supported-data-types">Supported Data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#relation-with-message-passing-apis">Relation with Message Passing APIs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dgl.optim.html">dgl.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="dgl.sampling.html">dgl.sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="dgl.sparse_v0.html">dgl.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="dgl.multiprocessing.html">dgl.multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">dgl.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="udf.html">User-defined Functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contribute.html">Contribute to DGL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/ffi.html">DGL Foreign Function Interface (FFI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../performance.html">Performance Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../env_var.html">Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources.html">Resources</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">DGL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">dgl.ops</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/api/python/dgl.ops.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dgl-ops">
<span id="apibackend"></span><h1>dgl.ops<a class="headerlink" href="#dgl-ops" title="Link to this heading"></a></h1>
<p>Frame-agnostic operators for message passing on graphs.</p>
<section id="gspmm-functions">
<h2>GSpMM functions<a class="headerlink" href="#gspmm-functions" title="Link to this heading"></a></h2>
<p>Generalized Sparse-Matrix Dense-Matrix Multiplication functions.
It <em>fuses</em> two steps into one kernel.</p>
<ol class="arabic simple">
<li><p>Computes messages by add/sub/mul/div source node and edge features,
or copy node features to edges.</p></li>
<li><p>Aggregate the messages by sum/max/min/mean as the features on destination nodes.</p></li>
</ol>
<p>Our implementation supports tensors on CPU/GPU in PyTorch/MXNet/Tensorflow
as input. All operators are equipped with autograd (computing the input gradients
given output gradient) and broadcasting (if the feature shape of operands do not
match, we first broadcast them to the same shape, then applies the binary
operators). Our broadcast semantics follows NumPy, please see
<a class="reference external" href="https://docs.scipy.org/doc/numpy/user/basics.broadcasting.html">https://docs.scipy.org/doc/numpy/user/basics.broadcasting.html</a>
for more details.</p>
<p>What do we mean by <em>fuses</em> is that the messages are not materialized on edges,
instead we compute the result on destination nodes directly, thus saving memory
cost. The space complexity of GSpMM operators is <span class="math notranslate nohighlight">\(O(|N|D)\)</span> where <span class="math notranslate nohighlight">\(|N|\)</span>
refers to the number of nodes in the graph, and <span class="math notranslate nohighlight">\(D\)</span> refers to the feature
size (<span class="math notranslate nohighlight">\(D=\prod_{i=1}^{N}D_i\)</span> if your feature is a multi-dimensional tensor).</p>
<p>The following is an example showing how GSpMM works (we use PyTorch as the backend
here, you can enjoy the same convenience on other frameworks by similar usage):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dgl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">th</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dgl.ops</span> <span class="k">as</span> <span class="nn">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">graph</span><span class="p">(([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>  <span class="c1"># 3 nodes, 6 edges</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">tensor([[1., 1.],</span>
<span class="go">        [1., 1.],</span>
<span class="go">        [1., 1.]], requires_grad=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">()</span>
<span class="go">tensor([[ 1.,  2.],</span>
<span class="go">        [ 3.,  4.],</span>
<span class="go">        [ 5.,  6.],</span>
<span class="go">        [ 7.,  8.],</span>
<span class="go">        [ 9., 10.],</span>
<span class="go">        [11., 12.]], requires_grad=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_1</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">u_mul_e_sum</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_1</span>  <span class="c1"># (10, 12) = ((1, 1) * (3, 4)) + ((1, 1) * (7, 8))</span>
<span class="go">tensor([[ 1.,  2.],</span>
<span class="go">        [10., 12.],</span>
<span class="go">        [25., 28.]], grad_fn=&lt;GSpMMBackward&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_1</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">grad</span>
<span class="go">tensor([[12., 15.],</span>
<span class="go">        [18., 20.],</span>
<span class="go">        [12., 13.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">grad</span>
<span class="go">tensor([[1., 1.],</span>
<span class="go">        [1., 1.],</span>
<span class="go">        [1., 1.],</span>
<span class="go">        [1., 1.],</span>
<span class="go">        [1., 1.],</span>
<span class="go">        [1., 1.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_2</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">copy_u_sum</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_2</span>
<span class="go">tensor([[1., 1.],</span>
<span class="go">        [2., 2.],</span>
<span class="go">        [3., 3.]], grad_fn=&lt;GSpMMBackward&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_3</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">u_add_e_max</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_3</span>
<span class="go">tensor([[ 2.,  3.],</span>
<span class="go">        [ 8.,  9.],</span>
<span class="go">        [12., 13.]], grad_fn=&lt;GSpMMBackward&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y1</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># test broadcast</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">u_mul_e_sum</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># (2,), (4, 2) -&gt; (4, 2)</span>
<span class="go">torch.Size([3, 4, 2])</span>
</pre></div>
</div>
<p>For all operators, the input graph could either be a homogeneous or a bipartite
graph.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.gspmm.html#dgl.ops.gspmm" title="dgl.ops.gspmm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gspmm</span></code></a>(g, op, reduce_op, lhs_data, rhs_data)</p></td>
<td><p>Generalized Sparse Matrix Multiplication interface.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_add_e_sum.html#dgl.ops.u_add_e_sum" title="dgl.ops.u_add_e_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_add_e_sum</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_sub_e_sum.html#dgl.ops.u_sub_e_sum" title="dgl.ops.u_sub_e_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_sub_e_sum</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_mul_e_sum.html#dgl.ops.u_mul_e_sum" title="dgl.ops.u_mul_e_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_mul_e_sum</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_div_e_sum.html#dgl.ops.u_div_e_sum" title="dgl.ops.u_div_e_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_div_e_sum</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_add_e_max.html#dgl.ops.u_add_e_max" title="dgl.ops.u_add_e_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_add_e_max</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_sub_e_max.html#dgl.ops.u_sub_e_max" title="dgl.ops.u_sub_e_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_sub_e_max</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_mul_e_max.html#dgl.ops.u_mul_e_max" title="dgl.ops.u_mul_e_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_mul_e_max</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_div_e_max.html#dgl.ops.u_div_e_max" title="dgl.ops.u_div_e_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_div_e_max</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_add_e_min.html#dgl.ops.u_add_e_min" title="dgl.ops.u_add_e_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_add_e_min</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_sub_e_min.html#dgl.ops.u_sub_e_min" title="dgl.ops.u_sub_e_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_sub_e_min</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_mul_e_min.html#dgl.ops.u_mul_e_min" title="dgl.ops.u_mul_e_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_mul_e_min</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_div_e_min.html#dgl.ops.u_div_e_min" title="dgl.ops.u_div_e_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_div_e_min</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_add_e_mean.html#dgl.ops.u_add_e_mean" title="dgl.ops.u_add_e_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_add_e_mean</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_sub_e_mean.html#dgl.ops.u_sub_e_mean" title="dgl.ops.u_sub_e_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_sub_e_mean</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_mul_e_mean.html#dgl.ops.u_mul_e_mean" title="dgl.ops.u_mul_e_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_mul_e_mean</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_div_e_mean.html#dgl.ops.u_div_e_mean" title="dgl.ops.u_div_e_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_div_e_mean</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.copy_u_sum.html#dgl.ops.copy_u_sum" title="dgl.ops.copy_u_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_u_sum</span></code></a>(g, x)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.copy_e_sum.html#dgl.ops.copy_e_sum" title="dgl.ops.copy_e_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_e_sum</span></code></a>(g, x)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.copy_u_max.html#dgl.ops.copy_u_max" title="dgl.ops.copy_u_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_u_max</span></code></a>(g, x)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.copy_e_max.html#dgl.ops.copy_e_max" title="dgl.ops.copy_e_max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_e_max</span></code></a>(g, x)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.copy_u_min.html#dgl.ops.copy_u_min" title="dgl.ops.copy_u_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_u_min</span></code></a>(g, x)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.copy_e_min.html#dgl.ops.copy_e_min" title="dgl.ops.copy_e_min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_e_min</span></code></a>(g, x)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.copy_u_mean.html#dgl.ops.copy_u_mean" title="dgl.ops.copy_u_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_u_mean</span></code></a>(g, x)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.copy_e_mean.html#dgl.ops.copy_e_mean" title="dgl.ops.copy_e_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_e_mean</span></code></a>(g, x)</p></td>
<td><p>Generalized SpMM function.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="gsddmm-functions">
<h2>GSDDMM functions<a class="headerlink" href="#gsddmm-functions" title="Link to this heading"></a></h2>
<p>Generalized Sampled Dense-Dense Matrix Multiplication.
It computes edge features by add/sub/mul/div/dot features on source/destination
nodes or edges.</p>
<p>Like GSpMM, our implementation supports tensors on CPU/GPU in
PyTorch/MXNet/Tensorflow as input. All operators are equipped with autograd and
broadcasting.</p>
<p>The memory cost of GSDDMM is <span class="math notranslate nohighlight">\(O(|E|D)\)</span> where <span class="math notranslate nohighlight">\(|E|\)</span> refers to the number
of edges in the graph while <span class="math notranslate nohighlight">\(D\)</span> refers to the feature size.</p>
<p>Note that we support <code class="docutils literal notranslate"><span class="pre">dot</span></code> operator, which semantically is the same as reduce
the last dimension by sum to the result of <code class="docutils literal notranslate"><span class="pre">mul</span></code> operator. However, the <code class="docutils literal notranslate"><span class="pre">dot</span></code>
is more memory efficient because it <em>fuses</em> <code class="docutils literal notranslate"><span class="pre">mul</span></code> and sum reduction, which is
critical in the cases while the feature size on last dimension is non-trivial
(e.g. multi-head attention in Transformer-like models).</p>
<p>The following is an example showing how GSDDMM works:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dgl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">th</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dgl.ops</span> <span class="k">as</span> <span class="nn">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">graph</span><span class="p">(([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>  <span class="c1"># 3 nodes, 6 edges</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">tensor([[1., 1.],</span>
<span class="go">        [1., 1.],</span>
<span class="go">        [1., 1.]], requires_grad=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>
<span class="go">tensor([[1., 2.],</span>
<span class="go">        [3., 4.],</span>
<span class="go">        [5., 6.]], requires_grad=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
<span class="go">tensor([[[2., 2.]],</span>
<span class="go">        [[2., 2.]],</span>
<span class="go">        [[2., 2.]],</span>
<span class="go">        [[2., 2.]],</span>
<span class="go">        [[2., 2.]],</span>
<span class="go">        [[2., 2.]]], grad_fn=&lt;MulBackward0&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out1</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">u_div_v</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">tensor([[1.0000, 0.5000],</span>
<span class="go">        [0.3333, 0.2500],</span>
<span class="go">        [0.2000, 0.1667],</span>
<span class="go">        [0.3333, 0.2500],</span>
<span class="go">        [0.2000, 0.1667],</span>
<span class="go">        [0.2000, 0.1667]], grad_fn=&lt;GSDDMMBackward&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out1</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">grad</span>
<span class="go">tensor([[1.5333, 0.9167],</span>
<span class="go">        [0.5333, 0.4167],</span>
<span class="go">        [0.2000, 0.1667]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">grad</span>
<span class="go">tensor([[-1.0000, -0.2500],</span>
<span class="go">        [-0.2222, -0.1250],</span>
<span class="go">        [-0.1200, -0.0833]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out2</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">e_sub_v</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out2</span>
<span class="go">tensor([[[ 1.,  0.]],</span>
<span class="go">        [[-1., -2.]],</span>
<span class="go">        [[-3., -4.]],</span>
<span class="go">        [[-1., -2.]],</span>
<span class="go">        [[-3., -4.]],</span>
<span class="go">        [[-3., -4.]]], grad_fn=&lt;GSDDMMBackward&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out3</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">copy_v</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out3</span>
<span class="go">tensor([[1., 2.],</span>
<span class="go">        [3., 4.],</span>
<span class="go">        [5., 6.],</span>
<span class="go">        [3., 4.],</span>
<span class="go">        [5., 6.],</span>
<span class="go">        [5., 6.]], grad_fn=&lt;GSDDMMBackward&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out4</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">u_dot_v</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out4</span>  <span class="c1"># the last dimension was reduced to size 1.</span>
<span class="go">tensor([[ 3.],</span>
<span class="go">        [ 7.],</span>
<span class="go">        [11.],</span>
<span class="go">        [ 7.],</span>
<span class="go">        [11.],</span>
<span class="go">        [11.]], grad_fn=&lt;GSDDMMBackward&gt;)</span>
</pre></div>
</div>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.gsddmm.html#dgl.ops.gsddmm" title="dgl.ops.gsddmm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gsddmm</span></code></a>(g, op, lhs_data, rhs_data[, ...])</p></td>
<td><p>Generalized Sampled-Dense-Dense Matrix Multiplication interface.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_add_v.html#dgl.ops.u_add_v" title="dgl.ops.u_add_v"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_add_v</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_sub_v.html#dgl.ops.u_sub_v" title="dgl.ops.u_sub_v"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_sub_v</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_mul_v.html#dgl.ops.u_mul_v" title="dgl.ops.u_mul_v"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_mul_v</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_dot_v.html#dgl.ops.u_dot_v" title="dgl.ops.u_dot_v"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_dot_v</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_div_v.html#dgl.ops.u_div_v" title="dgl.ops.u_div_v"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_div_v</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_add_e.html#dgl.ops.u_add_e" title="dgl.ops.u_add_e"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_add_e</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_sub_e.html#dgl.ops.u_sub_e" title="dgl.ops.u_sub_e"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_sub_e</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_mul_e.html#dgl.ops.u_mul_e" title="dgl.ops.u_mul_e"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_mul_e</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_dot_e.html#dgl.ops.u_dot_e" title="dgl.ops.u_dot_e"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_dot_e</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.u_div_e.html#dgl.ops.u_div_e" title="dgl.ops.u_div_e"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_div_e</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.e_add_v.html#dgl.ops.e_add_v" title="dgl.ops.e_add_v"><code class="xref py py-obj docutils literal notranslate"><span class="pre">e_add_v</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.e_sub_v.html#dgl.ops.e_sub_v" title="dgl.ops.e_sub_v"><code class="xref py py-obj docutils literal notranslate"><span class="pre">e_sub_v</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.e_mul_v.html#dgl.ops.e_mul_v" title="dgl.ops.e_mul_v"><code class="xref py py-obj docutils literal notranslate"><span class="pre">e_mul_v</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.e_dot_v.html#dgl.ops.e_dot_v" title="dgl.ops.e_dot_v"><code class="xref py py-obj docutils literal notranslate"><span class="pre">e_dot_v</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.e_div_v.html#dgl.ops.e_div_v" title="dgl.ops.e_div_v"><code class="xref py py-obj docutils literal notranslate"><span class="pre">e_div_v</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.v_add_u.html#dgl.ops.v_add_u" title="dgl.ops.v_add_u"><code class="xref py py-obj docutils literal notranslate"><span class="pre">v_add_u</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.v_sub_u.html#dgl.ops.v_sub_u" title="dgl.ops.v_sub_u"><code class="xref py py-obj docutils literal notranslate"><span class="pre">v_sub_u</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.v_mul_u.html#dgl.ops.v_mul_u" title="dgl.ops.v_mul_u"><code class="xref py py-obj docutils literal notranslate"><span class="pre">v_mul_u</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.v_dot_u.html#dgl.ops.v_dot_u" title="dgl.ops.v_dot_u"><code class="xref py py-obj docutils literal notranslate"><span class="pre">v_dot_u</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.v_div_u.html#dgl.ops.v_div_u" title="dgl.ops.v_div_u"><code class="xref py py-obj docutils literal notranslate"><span class="pre">v_div_u</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.e_add_u.html#dgl.ops.e_add_u" title="dgl.ops.e_add_u"><code class="xref py py-obj docutils literal notranslate"><span class="pre">e_add_u</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.e_sub_u.html#dgl.ops.e_sub_u" title="dgl.ops.e_sub_u"><code class="xref py py-obj docutils literal notranslate"><span class="pre">e_sub_u</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.e_mul_u.html#dgl.ops.e_mul_u" title="dgl.ops.e_mul_u"><code class="xref py py-obj docutils literal notranslate"><span class="pre">e_mul_u</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.e_dot_u.html#dgl.ops.e_dot_u" title="dgl.ops.e_dot_u"><code class="xref py py-obj docutils literal notranslate"><span class="pre">e_dot_u</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.e_div_u.html#dgl.ops.e_div_u" title="dgl.ops.e_div_u"><code class="xref py py-obj docutils literal notranslate"><span class="pre">e_div_u</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.v_add_e.html#dgl.ops.v_add_e" title="dgl.ops.v_add_e"><code class="xref py py-obj docutils literal notranslate"><span class="pre">v_add_e</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.v_sub_e.html#dgl.ops.v_sub_e" title="dgl.ops.v_sub_e"><code class="xref py py-obj docutils literal notranslate"><span class="pre">v_sub_e</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.v_mul_e.html#dgl.ops.v_mul_e" title="dgl.ops.v_mul_e"><code class="xref py py-obj docutils literal notranslate"><span class="pre">v_mul_e</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.v_dot_e.html#dgl.ops.v_dot_e" title="dgl.ops.v_dot_e"><code class="xref py py-obj docutils literal notranslate"><span class="pre">v_dot_e</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.v_div_e.html#dgl.ops.v_div_e" title="dgl.ops.v_div_e"><code class="xref py py-obj docutils literal notranslate"><span class="pre">v_div_e</span></code></a>(g, x, y)</p></td>
<td><p>Generalized SDDMM function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.copy_u.html#dgl.ops.copy_u" title="dgl.ops.copy_u"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_u</span></code></a>(g, x)</p></td>
<td><p>Generalized SDDMM function that copies source node features to edges.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.copy_v.html#dgl.ops.copy_v" title="dgl.ops.copy_v"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_v</span></code></a>(g, x)</p></td>
<td><p>Generalized SDDMM function that copies destination node features to edges.</p></td>
</tr>
</tbody>
</table>
<p>Like GSpMM, GSDDMM operators support both homogeneous and bipartite graph.</p>
</section>
<section id="segment-reduce-module">
<h2>Segment Reduce Module<a class="headerlink" href="#segment-reduce-module" title="Link to this heading"></a></h2>
<p>DGL provide operators to reduce value tensor along the first dimension by segments.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.segment_reduce.html#dgl.ops.segment_reduce" title="dgl.ops.segment_reduce"><code class="xref py py-obj docutils literal notranslate"><span class="pre">segment_reduce</span></code></a>(seglen, value[, reducer])</p></td>
<td><p>Segment reduction operator.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="gathermm-and-segmentmm-module">
<h2>GatherMM and SegmentMM Module<a class="headerlink" href="#gathermm-and-segmentmm-module" title="Link to this heading"></a></h2>
<p>SegmentMM: DGL provide operators to perform matrix multiplication according to segments.</p>
<p>GatherMM: DGL provide operators to gather data according to the given indices and perform matrix multiplication.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/dgl.ops.gather_mm.html#dgl.ops.gather_mm" title="dgl.ops.gather_mm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gather_mm</span></code></a>(a, b, *, idx_b)</p></td>
<td><p>Gather data according to the given indices and perform matrix multiplication.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/dgl.ops.segment_mm.html#dgl.ops.segment_mm" title="dgl.ops.segment_mm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">segment_mm</span></code></a>(a, b, seglen_a)</p></td>
<td><p>Performs matrix multiplication according to segments.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="supported-data-types">
<h2>Supported Data types<a class="headerlink" href="#supported-data-types" title="Link to this heading"></a></h2>
<p>Operators defined in <code class="docutils literal notranslate"><span class="pre">dgl.ops</span></code> support floating point data types, i.e. the operands
must be <code class="docutils literal notranslate"><span class="pre">half</span></code> (<code class="docutils literal notranslate"><span class="pre">float16</span></code>) /<code class="docutils literal notranslate"><span class="pre">float</span></code>/<code class="docutils literal notranslate"><span class="pre">double</span></code> tensors.
The input tensors must have the same data type (if one input tensor has type float16
and the other input tensor has data type float32, user must convert one of them to
align with the other one).</p>
<p><code class="docutils literal notranslate"><span class="pre">float16</span></code> data type support is disabled by default as it has a minimum GPU
compute capacity requirement of <code class="docutils literal notranslate"><span class="pre">sm_53</span></code> (Pascal, Volta, Turing and Ampere
architectures).</p>
<p>User can enable float16 for mixed precision training by compiling DGL from source
(see <a class="reference internal" href="../../guide/mixed_precision.html"><span class="doc">Mixed Precision Training</span></a> tutorial for details).</p>
</section>
<section id="relation-with-message-passing-apis">
<h2>Relation with Message Passing APIs<a class="headerlink" href="#relation-with-message-passing-apis" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">dgl.update_all</span></code> and <code class="docutils literal notranslate"><span class="pre">dgl.apply_edges</span></code> calls with built-in message/reduce functions
would be dispatched into function calls of operators defined in <code class="docutils literal notranslate"><span class="pre">dgl.ops</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dgl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">th</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dgl.ops</span> <span class="k">as</span> <span class="nn">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dgl.function</span> <span class="k">as</span> <span class="nn">fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">rand_graph</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>   <span class="c1"># create a DGLGraph with 100 nodes and 1000 edges.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>            <span class="c1"># node features.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">th</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># dgl.update_all + builtin functions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">srcdata</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>              <span class="c1"># srcdata is the same as ndata for graphs with one node type.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">edata</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">update_all</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">u_mul_e</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">fn</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">dstdata</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>              <span class="c1"># dstdata is the same as ndata for graphs with one node type.</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># use GSpMM operators defined in dgl.ops directly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">u_mul_e_sum</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># dgl.apply_edges + builtin functions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">srcdata</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">dstdata</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">apply_edges</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">u_dot_v</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edata</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># use GSDDMM operators defined in dgl.ops directly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">u_dot_v</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>It up to user to decide whether to use message-passing APIs or GSpMM/GSDDMM operators, and both
of them have the same efficiency. Programs written in message-passing APIs look more like DGL-style
but in some cases calling GSpMM/GSDDMM operators is more concise.</p>
<p>Note that on PyTorch all operators defined in <code class="docutils literal notranslate"><span class="pre">dgl.ops</span></code> support higher-order gradients, so as
message passing APIs because they entirely depend on these operators.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="nn.functional.html" class="btn btn-neutral float-left" title="dgl.nn.functional" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../generated/dgl.ops.gspmm.html" class="btn btn-neutral float-right" title="dgl.ops.gspmm" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, DGL Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>