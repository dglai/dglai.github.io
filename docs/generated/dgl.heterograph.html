<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dgl.heterograph &mdash; DGL 2.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=0bf289b5" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=9caaf7ed"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=ccdb6887"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="dgl.from_cugraph" href="dgl.from_cugraph.html" />
    <link rel="prev" title="dgl.graph" href="dgl.graph.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            DGL
          </a>
              <div class="version">
                2.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Install and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/blitz/index.html">A Blitz Introduction to DGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Materials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../stochastic_training/index.html">🆕 Stochastic Training of GNNs with GraphBolt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide_cn/index.html">用户指南【包含过时信息】</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide_ko/index.html">사용자 가이드[시대에 뒤쳐진]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphtransformer/index.html">🆕 Tutorial: Graph Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/sparse/index.html">Tutorials: dgl.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cpu/index.html">Training on CPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/multi/index.html">Training on Multiple GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dist/index.html">Distributed training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/index.html">Paper Study with DGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api/python/dgl.html">dgl</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../api/python/dgl.html#graph-create-ops">Graph Create Ops</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="dgl.graph.html">dgl.graph</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">dgl.heterograph</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dgl.heterograph"><code class="docutils literal notranslate"><span class="pre">heterograph()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dgl.from_cugraph.html">dgl.from_cugraph</a></li>
<li class="toctree-l3"><a class="reference internal" href="dgl.from_scipy.html">dgl.from_scipy</a></li>
<li class="toctree-l3"><a class="reference internal" href="dgl.from_networkx.html">dgl.from_networkx</a></li>
<li class="toctree-l3"><a class="reference internal" href="dgl.bipartite_from_scipy.html">dgl.bipartite_from_scipy</a></li>
<li class="toctree-l3"><a class="reference internal" href="dgl.bipartite_from_networkx.html">dgl.bipartite_from_networkx</a></li>
<li class="toctree-l3"><a class="reference internal" href="dgl.rand_graph.html">dgl.rand_graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="dgl.rand_bipartite.html">dgl.rand_bipartite</a></li>
<li class="toctree-l3"><a class="reference internal" href="dgl.knn_graph.html">dgl.knn_graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="dgl.segmented_knn_graph.html">dgl.segmented_knn_graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="dgl.radius_graph.html">dgl.radius_graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="dgl.create_block.html">dgl.create_block</a></li>
<li class="toctree-l3"><a class="reference internal" href="dgl.block_to_graph.html">dgl.block_to_graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="dgl.merge.html">dgl.merge</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/python/dgl.html#subgraph-extraction-ops">Subgraph Extraction Ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/python/dgl.html#graph-transform-ops">Graph Transform Ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/python/dgl.html#graph-positional-encoding-ops">Graph Positional Encoding Ops:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/python/dgl.html#graph-partition-utilities">Graph Partition Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/python/dgl.html#batching-and-reading-out-ops">Batching and Reading Out Ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/python/dgl.html#adjacency-related-utilities">Adjacency Related Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/python/dgl.html#graph-traversal-message-propagation">Graph Traversal &amp; Message Propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/python/dgl.html#homophily-measures">Homophily Measures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/python/dgl.html#label-informativeness-measures">Label Informativeness Measures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/python/dgl.html#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.data.html">dgl.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.dataloading.html">dgl.dataloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.DGLGraph.html">dgl.DGLGraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.distributed.html">dgl.distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.function.html">dgl.function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.geometry.html">dgl.geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.graphbolt.html">🆕 dgl.graphbolt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/nn-pytorch.html">dgl.nn (PyTorch)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/nn.functional.html">dgl.nn.functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.ops.html">dgl.ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.optim.html">dgl.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.sampling.html">dgl.sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.sparse_v0.html">dgl.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.multiprocessing.html">dgl.multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/transforms.html">dgl.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/udf.html">User-defined Functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contribute to DGL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/ffi.html">DGL Foreign Function Interface (FFI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html">Performance Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env_var.html">Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">Resources</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DGL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api/python/dgl.html">dgl</a></li>
      <li class="breadcrumb-item active">dgl.heterograph</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/dgl.heterograph.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dgl-heterograph">
<h1>dgl.heterograph<a class="headerlink" href="#dgl-heterograph" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="dgl.heterograph">
<span class="sig-prename descclassname"><span class="pre">dgl.</span></span><span class="sig-name descname"><span class="pre">heterograph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_nodes_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dgl/convert.html#heterograph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dgl.heterograph" title="Link to this definition"></a></dt>
<dd><p>Create a heterogeneous graph and return.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dict</strong> (<em>graph data</em>) – <p>The dictionary data for constructing a heterogeneous graph. The keys are in the form of
string triplets (src_type, edge_type, dst_type), specifying the source node,
edge, and destination node types. The values are graph data in the form of
<span class="math notranslate nohighlight">\((U, V)\)</span>, where <span class="math notranslate nohighlight">\((U[i], V[i])\)</span> forms the edge with ID <span class="math notranslate nohighlight">\(i\)</span>.
The allowed graph data formats are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">(Tensor,</span> <span class="pre">Tensor)</span></code>: Each tensor must be a 1D tensor containing node IDs. DGL calls
this format “tuple of node-tensors”. The tensors should have the same data type,
which must be either int32 or int64. They should also have the same device context
(see below the descriptions of <code class="xref py py-attr docutils literal notranslate"><span class="pre">idtype</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">device</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">('coo',</span> <span class="pre">(Tensor,</span> <span class="pre">Tensor))</span></code>: Same as <code class="docutils literal notranslate"><span class="pre">(Tensor,</span> <span class="pre">Tensor)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">('csr',</span> <span class="pre">(Tensor,</span> <span class="pre">Tensor,</span> <span class="pre">Tensor))</span></code>: The three tensors form the CSR representation
of the graph’s adjacency matrix.  The first one is the row index pointer.  The
second one is the column indices.  The third one is the edge IDs, which can be empty
(i.e. with 0 elements) to represent consecutive integer IDs starting from 0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">('csc',</span> <span class="pre">(Tensor,</span> <span class="pre">Tensor,</span> <span class="pre">Tensor))</span></code>: The three tensors form the CSC representation
of the graph’s adjacency matrix.  The first one is the column index pointer.  The
second one is the row indices.  The third one is the edge IDs, which can be empty
to represent consecutive integer IDs starting from 0.</p></li>
</ul>
<p>The tensors can be replaced with any iterable of integers (e.g. list, tuple,
numpy.ndarray).</p>
</p></li>
<li><p><strong>num_nodes_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – The number of nodes for some node types, which is a dictionary mapping a node type
<span class="math notranslate nohighlight">\(T\)</span> to the number of <span class="math notranslate nohighlight">\(T\)</span>-typed nodes. If not given for a node type
<span class="math notranslate nohighlight">\(T\)</span>, DGL finds the largest ID appearing in <em>every</em> graph data whose source
or destination node type is <span class="math notranslate nohighlight">\(T\)</span>, and sets the number of nodes to be that ID
plus one. If given and the value is no greater than the largest ID for some node type,
DGL will raise an error. By default, DGL infers the number of nodes for all node types.</p></li>
<li><p><strong>idtype</strong> (<em>int32</em><em> or </em><em>int64</em><em>, </em><em>optional</em>) – The data type for storing the structure-related graph information such as node and
edge IDs. It should be a framework-specific data type object (e.g., <code class="docutils literal notranslate"><span class="pre">torch.int32</span></code>).
If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), DGL infers the ID type from the <code class="xref py py-attr docutils literal notranslate"><span class="pre">data_dict</span></code> argument.</p></li>
<li><p><strong>device</strong> (<em>device context</em><em>, </em><em>optional</em>) – The device of the returned graph, which should be a framework-specific device object
(e.g., <code class="docutils literal notranslate"><span class="pre">torch.device</span></code>). If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), DGL uses the device of the tensors of
the <a class="reference internal" href="../api/python/dgl.data.html#module-dgl.data" title="dgl.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> argument. If <a class="reference internal" href="../api/python/dgl.data.html#module-dgl.data" title="dgl.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> is not a tuple of node-tensors, the
returned graph is on CPU.  If the specified <code class="xref py py-attr docutils literal notranslate"><span class="pre">device</span></code> differs from that of the
provided tensors, it casts the given tensors to the specified device first.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created graph.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../api/python/dgl.DGLGraph.html#dgl.DGLGraph" title="dgl.DGLGraph">DGLGraph</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic">
<li><p>If the <code class="xref py py-attr docutils literal notranslate"><span class="pre">idtype</span></code> argument is not given then:</p>
<ul class="simple">
<li><p>in the case of the tuple of node-tensor format, DGL uses
the data type of the given ID tensors.</p></li>
<li><p>in the case of the tuple of sequence format, DGL uses int64.</p></li>
</ul>
<p>Once the graph has been created, you can change the data type by using
<a class="reference internal" href="dgl.DGLGraph.long.html#dgl.DGLGraph.long" title="dgl.DGLGraph.long"><code class="xref py py-func docutils literal notranslate"><span class="pre">dgl.DGLGraph.long()</span></code></a> or <a class="reference internal" href="dgl.DGLGraph.int.html#dgl.DGLGraph.int" title="dgl.DGLGraph.int"><code class="xref py py-func docutils literal notranslate"><span class="pre">dgl.DGLGraph.int()</span></code></a>.</p>
<p>If the specified <code class="xref py py-attr docutils literal notranslate"><span class="pre">idtype</span></code> argument differs from the data type of the provided
tensors, it casts the given tensors to the specified data type first.</p>
</li>
<li><p>The most efficient construction approach is to provide a tuple of node tensors without
specifying <code class="xref py py-attr docutils literal notranslate"><span class="pre">idtype</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">device</span></code>. This is because the returned graph shares
the storage with the input node-tensors in this case.</p></li>
<li><p>DGL internally maintains multiple copies of the graph structure in different sparse
formats and chooses the most efficient one depending on the computation invoked.
If memory usage becomes an issue in the case of large graphs, use
<a class="reference internal" href="dgl.DGLGraph.formats.html#dgl.DGLGraph.formats" title="dgl.DGLGraph.formats"><code class="xref py py-func docutils literal notranslate"><span class="pre">dgl.DGLGraph.formats()</span></code></a> to restrict the allowed formats.</p></li>
<li><p>DGL internally decides a deterministic order for the same set of node types and canonical
edge types, which does not necessarily follow the order in <code class="xref py py-attr docutils literal notranslate"><span class="pre">data_dict</span></code>.</p></li>
</ol>
<p class="rubric">Examples</p>
<p>The following example uses PyTorch backend.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dgl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
</pre></div>
</div>
<p>Create a heterograph with three canonical edge types.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;follows&#39;</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;follows&#39;</span><span class="p">,</span> <span class="s1">&#39;topic&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;plays&#39;</span><span class="p">,</span> <span class="s1">&#39;game&#39;</span><span class="p">):</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">heterograph</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span>
<span class="go">Graph(num_nodes={&#39;game&#39;: 5, &#39;topic&#39;: 3, &#39;user&#39;: 4},</span>
<span class="go">      num_edges={(&#39;user&#39;, &#39;follows&#39;, &#39;topic&#39;): 2, (&#39;user&#39;, &#39;follows&#39;, &#39;user&#39;): 2,</span>
<span class="go">                 (&#39;user&#39;, &#39;plays&#39;, &#39;game&#39;): 2},</span>
<span class="go">      metagraph=[(&#39;user&#39;, &#39;topic&#39;, &#39;follows&#39;), (&#39;user&#39;, &#39;user&#39;, &#39;follows&#39;),</span>
<span class="go">                 (&#39;user&#39;, &#39;game&#39;, &#39;plays&#39;)])</span>
</pre></div>
</div>
<p>Explicitly specify the number of nodes for each node type in the graph.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">num_nodes_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;topic&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;game&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">heterograph</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">num_nodes_dict</span><span class="o">=</span><span class="n">num_nodes_dict</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a graph on the first GPU with data type int32.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">heterograph</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">idtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dgl.graph.html" class="btn btn-neutral float-left" title="dgl.graph" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dgl.from_cugraph.html" class="btn btn-neutral float-right" title="dgl.from_cugraph" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, DGL Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>